import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
import contextlib
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    g = g.add(buf, alpha=momentum) if group['nesterov'] else buf
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

def norm(x):
    return F.rms_norm(x, (x.size(-1),))

class CastedLinear(nn.Linear):

    def __init__(self, in_features, out_features):
        super().__init__(in_features, out_features, bias=False)

    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=15000):
        super().__init__()
        self.register_buffer('inv_freq', (1 / base) ** (torch.arange(0, dim, 2) / dim))
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            t = torch.arange(seq_len, device=x.device)
            freqs = torch.outer(t, self.inv_freq)
            self.seq_len_cached = seq_len
            self.cos_cached = freqs.cos()
            self.sin_cached = freqs.sin()
        cos, sin = self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]
        # apply_rotary_emb(x, cos, sin)
        x1, x2 = x.chunk(2, dim=3)
        y1 = x1 * cos + x2 * sin
        y2 = x1 * (-sin) + x2 * cos
        return torch.cat((y1, y2), 3).type_as(x)

class CausalSelfAttention(nn.Module):

    def __init__(self, dim, n_head):
        super().__init__()
        assert dim % n_head == 0
        self.n_head = n_head
        self.c_q = CastedLinear(dim, dim)
        self.c_k = CastedLinear(dim, dim)
        self.c_v = CastedLinear(dim, dim)
        # value residual lambda
        self.lamb_v = nn.Parameter(torch.tensor(0.5)) # @Grad62304977
        # rotary embeddings
        self.rotary = Rotary(dim // n_head) # dim // n_head = head_dim
        # output projection
        self.c_proj = CastedLinear(dim, dim)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        # Add learnable scales for RMS norm
        self.norm_q_scale = nn.Parameter(torch.ones(1))
        self.norm_k_scale = nn.Parameter(torch.ones(1))

    def forward(self, x, v0, block_mask):
        B, T = x.size(0), x.size(1) # batch size, sequence length
        assert B == 1, "Must use batch size = 1 for FlexAttention"
        q = self.c_q(x).view(B, T, self.n_head, -1)
        k = self.c_k(x).view(B, T, self.n_head, -1)
        v = self.c_v(x).view(B, T, self.n_head, -1)
        v = (1 - self.lamb_v) * v + self.lamb_v * v0.view_as(v) # @Grad62304977
        q = self.norm_q_scale * norm(q)  # QK norm with learnable scale
        k = self.norm_k_scale * norm(k)  # QK norm with learnable scale
        q, k = self.rotary(q), self.rotary(k)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y

class MLP(nn.Module):

    def __init__(self, dim):
        super().__init__()
        self.c_fc   = CastedLinear(dim, 4 * dim)
        self.c_proj = CastedLinear(4 * dim, dim)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x



class Block(nn.Module):
    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config.n_embd, config.n_head)
        self.mlp = MLP(config.n_embd)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))
        # Add learnable scales for RMS norm
        self.norm1_scale = nn.Parameter(torch.ones(1))
        self.norm2_scale = nn.Parameter(torch.ones(1))

    def forward(self, x, v0, x0, block_mask):
        # U-Net mixing
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        
        # Compute attention
        x_norm = self.norm1_scale * norm(x)
        attn_output = self.attn(x_norm, v0, block_mask)
        x = x + attn_output
        
        # MLP
        x_norm = self.norm2_scale * norm(x)
        mlp_output = self.mlp(x_norm)
        x = x + mlp_output
        
        return x


# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768

class GPT(nn.Module):

    def __init__(self, config):
        super().__init__()

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            # token value embeddings by @KoszarskyB - inspired by @Grad62304977's value residual learning
            vte = nn.Embedding(config.vocab_size, config.n_embd*12),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size)
        self.lm_head.weight.data.zero_() # @Grad62304977

        self.register_buffer('noise_scale', torch.tensor(0.1))

        # Add learnable scales for RMS norm
        self.norm1_scale = nn.Parameter(torch.ones(1))
        self.norm2_scale = nn.Parameter(torch.ones(1))



    def forward(self, idx, target, attn_blocksize):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
          causal_mask = q_idx >= kv_idx
          document_mask = docs[q_idx] == docs[kv_idx]
          window_mask = q_idx - kv_idx < attn_blocksize
          return causal_mask & document_mask & window_mask

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)

        if self.training: 
            noise = torch.randn_like(x) * self.noise_scale
            x = x + noise

        x = self.norm1_scale * norm(x)
        x0 = x
        vi = self.transformer.vte(idx[None]).chunk(12, dim=-1)

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x = self.transformer.h[i](x, vi[i], x0, block_mask)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x = self.transformer.h[self.num_encoder_layers + i](x, vi[self.num_encoder_layers+i], x0, block_mask)

        x = self.norm2_scale * norm(x)
        logits = self.lm_head(x)
        logits = 30 * torch.tanh(logits / 30) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1440 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 650 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
T = args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (T * ddp_world_size) == 0
val_steps = args.val_tokens // (T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (ddp_world_size) == 0
train_accumulation_steps = args.batch_size // ddp_world_size

# load tokens
train_loader = DistributedDataLoader(args.input_bin, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight, raw_model.transformer.vte.weight], lr=0.6, betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight], lr=0.008, betas=(0.8, 0.95), fused=True)
params = list(raw_model.transformer.h.parameters())
matrix_params = [p for p in params if p.ndim == 2]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights, raw_model.norm1_scale, raw_model.norm2_scale]
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # Set the attention blocksize for the current step, in chunks of 64. By @fernbear.bsky.social
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    
    # Update noise scale to follow triangular schedule
    # Cosine decay from 0.01 to 0 over entire training
    progress = step / args.num_iterations 
    noise_scale = 0.01 * (1 + torch.cos(torch.tensor(progress * torch.pi)).item()) / 2
    raw_model.noise_scale.copy_(torch.tensor(noise_scale))

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        ctx = model.no_sync() if i < train_accumulation_steps else contextlib.nullcontext()
        with ctx: # there's no need to sync gradients every accumulation step
            # forward pass
            loss = model(x, y, attn_blocksize=attn_blocksize)
            # advance the dataset for the next batch
            x, y = train_loader.next_batch()
            # backward pass
            loss.backward()
        train_loss = loss.detach()
    for p in model.parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()====================================================================================================
Running pytorch 2.6.0.dev20241203+cu124 compiled for CUDA 12.4
nvidia-smi:
Sat Dec  7 07:43:54 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.183.06             Driver Version: 535.183.06   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H100 80GB HBM3          On  | 00000000:19:00.0 Off |                    0 |
| N/A   37C    P0              77W / 700W |      3MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA H100 80GB HBM3          On  | 00000000:3B:00.0 Off |                    0 |
| N/A   31C    P0             116W / 700W |    531MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA H100 80GB HBM3          On  | 00000000:4C:00.0 Off |                    0 |
| N/A   29C    P0             111W / 700W |    531MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA H100 80GB HBM3          On  | 00000000:5D:00.0 Off |                    0 |
| N/A   37C    P0             115W / 700W |    531MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA H100 80GB HBM3          On  | 00000000:9B:00.0 Off |                    0 |
| N/A   39C    P0             120W / 700W |    531MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA H100 80GB HBM3          On  | 00000000:BB:00.0 Off |                    0 |
| N/A   31C    P0             118W / 700W |    531MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA H100 80GB HBM3          On  | 00000000:CB:00.0 Off |                    0 |
| N/A   37C    P0             120W / 700W |    531MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA H100 80GB HBM3          On  | 00000000:DB:00.0 Off |                    0 |
| N/A   30C    P0             119W / 700W |    531MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1000000000 across 10 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1440 val_loss:10.8258 train_time:0ms step_avg:nanms
step:1/1440 train_loss:10.8258 train_time:33533ms step_avg:nanms
step:2/1440 train_loss:10.0733 train_time:33666ms step_avg:nanms
step:3/1440 train_loss:8.3573 train_time:33833ms step_avg:nanms
step:4/1440 train_loss:7.7794 train_time:34004ms step_avg:nanms
step:5/1440 train_loss:7.4991 train_time:34171ms step_avg:nanms
step:6/1440 train_loss:7.0249 train_time:34341ms step_avg:nanms
step:7/1440 train_loss:7.1911 train_time:34509ms step_avg:nanms
step:8/1440 train_loss:6.7413 train_time:34676ms step_avg:nanms
step:9/1440 train_loss:6.6168 train_time:34846ms step_avg:nanms
step:10/1440 train_loss:6.4733 train_time:35012ms step_avg:nanms
step:11/1440 train_loss:6.3980 train_time:134ms step_avg:nanms
step:12/1440 train_loss:6.3124 train_time:304ms step_avg:nanms
step:13/1440 train_loss:6.2320 train_time:471ms step_avg:157.03ms
step:14/1440 train_loss:6.2717 train_time:639ms step_avg:159.73ms
step:15/1440 train_loss:6.1526 train_time:806ms step_avg:161.22ms
step:16/1440 train_loss:6.1079 train_time:974ms step_avg:162.30ms
step:17/1440 train_loss:6.1500 train_time:1143ms step_avg:163.27ms
step:18/1440 train_loss:5.9574 train_time:1310ms step_avg:163.81ms
step:19/1440 train_loss:5.9876 train_time:1479ms step_avg:164.28ms
step:20/1440 train_loss:5.6725 train_time:1646ms step_avg:164.60ms
step:21/1440 train_loss:5.9834 train_time:1815ms step_avg:164.97ms
step:22/1440 train_loss:6.1655 train_time:1983ms step_avg:165.23ms
step:23/1440 train_loss:5.8494 train_time:2150ms step_avg:165.40ms
step:24/1440 train_loss:6.0045 train_time:2319ms step_avg:165.62ms
step:25/1440 train_loss:5.6847 train_time:2486ms step_avg:165.75ms
step:26/1440 train_loss:5.5753 train_time:2655ms step_avg:165.92ms
step:27/1440 train_loss:5.7747 train_time:2824ms step_avg:166.10ms
step:28/1440 train_loss:5.4042 train_time:2991ms step_avg:166.17ms
step:29/1440 train_loss:5.6744 train_time:3159ms step_avg:166.28ms
step:30/1440 train_loss:5.4558 train_time:3326ms step_avg:166.32ms
step:31/1440 train_loss:5.4189 train_time:3496ms step_avg:166.46ms
step:32/1440 train_loss:5.2637 train_time:3663ms step_avg:166.51ms
step:33/1440 train_loss:5.5851 train_time:3830ms step_avg:166.53ms
step:34/1440 train_loss:5.4773 train_time:4000ms step_avg:166.65ms
step:35/1440 train_loss:5.6058 train_time:4167ms step_avg:166.67ms
step:36/1440 train_loss:5.5342 train_time:4334ms step_avg:166.69ms
step:37/1440 train_loss:5.4379 train_time:4503ms step_avg:166.78ms
step:38/1440 train_loss:5.2801 train_time:4671ms step_avg:166.81ms
step:39/1440 train_loss:5.2934 train_time:4838ms step_avg:166.84ms
step:40/1440 train_loss:5.2187 train_time:5006ms step_avg:166.87ms
step:41/1440 train_loss:5.2240 train_time:5174ms step_avg:166.90ms
step:42/1440 train_loss:5.1490 train_time:5343ms step_avg:166.97ms
step:43/1440 train_loss:5.2454 train_time:5511ms step_avg:166.99ms
step:44/1440 train_loss:5.2024 train_time:5679ms step_avg:167.03ms
step:45/1440 train_loss:5.3370 train_time:5846ms step_avg:167.02ms
step:46/1440 train_loss:5.1363 train_time:6013ms step_avg:167.02ms
step:47/1440 train_loss:5.0405 train_time:6181ms step_avg:167.06ms
step:48/1440 train_loss:5.1733 train_time:6349ms step_avg:167.07ms
step:49/1440 train_loss:5.1086 train_time:6518ms step_avg:167.12ms
step:50/1440 train_loss:5.2241 train_time:6685ms step_avg:167.13ms
step:51/1440 train_loss:5.1153 train_time:6852ms step_avg:167.13ms
step:52/1440 train_loss:5.0014 train_time:7022ms step_avg:167.19ms
step:53/1440 train_loss:5.1365 train_time:7189ms step_avg:167.20ms
step:54/1440 train_loss:4.9848 train_time:7358ms step_avg:167.23ms
step:55/1440 train_loss:5.3753 train_time:7526ms step_avg:167.24ms
step:56/1440 train_loss:4.9811 train_time:7696ms step_avg:167.29ms
step:57/1440 train_loss:4.8572 train_time:7862ms step_avg:167.28ms
step:58/1440 train_loss:4.9542 train_time:8030ms step_avg:167.28ms
step:59/1440 train_loss:4.9722 train_time:8199ms step_avg:167.33ms
step:60/1440 train_loss:5.1069 train_time:8367ms step_avg:167.34ms
step:61/1440 train_loss:4.8114 train_time:8534ms step_avg:167.34ms
step:62/1440 train_loss:4.9269 train_time:8703ms step_avg:167.37ms
step:63/1440 train_loss:4.9289 train_time:8870ms step_avg:167.37ms
step:64/1440 train_loss:4.8302 train_time:9038ms step_avg:167.37ms
step:65/1440 train_loss:4.7547 train_time:9206ms step_avg:167.38ms
step:66/1440 train_loss:4.8705 train_time:9373ms step_avg:167.38ms
step:67/1440 train_loss:4.7843 train_time:9542ms step_avg:167.40ms
step:68/1440 train_loss:5.0382 train_time:9709ms step_avg:167.40ms
step:69/1440 train_loss:4.6852 train_time:9878ms step_avg:167.42ms
step:70/1440 train_loss:4.7866 train_time:10045ms step_avg:167.42ms
step:71/1440 train_loss:4.9093 train_time:10213ms step_avg:167.42ms
step:72/1440 train_loss:4.8182 train_time:10383ms step_avg:167.46ms
step:73/1440 train_loss:4.7156 train_time:10550ms step_avg:167.46ms
step:74/1440 train_loss:4.8450 train_time:10719ms step_avg:167.49ms
step:75/1440 train_loss:4.7774 train_time:10887ms step_avg:167.50ms
step:76/1440 train_loss:4.7509 train_time:11054ms step_avg:167.49ms
step:77/1440 train_loss:4.8513 train_time:11224ms step_avg:167.52ms
step:78/1440 train_loss:5.0703 train_time:11392ms step_avg:167.54ms
step:79/1440 train_loss:4.7355 train_time:11560ms step_avg:167.54ms
step:80/1440 train_loss:4.7995 train_time:11727ms step_avg:167.53ms
step:81/1440 train_loss:4.5928 train_time:11895ms step_avg:167.54ms
step:82/1440 train_loss:4.7470 train_time:12063ms step_avg:167.54ms
step:83/1440 train_loss:4.7099 train_time:12230ms step_avg:167.53ms
step:84/1440 train_loss:4.7034 train_time:12400ms step_avg:167.56ms
step:85/1440 train_loss:4.5770 train_time:12567ms step_avg:167.56ms
step:86/1440 train_loss:4.7910 train_time:12734ms step_avg:167.55ms
step:87/1440 train_loss:4.7036 train_time:12903ms step_avg:167.57ms
step:88/1440 train_loss:4.6747 train_time:13070ms step_avg:167.56ms
step:89/1440 train_loss:4.6286 train_time:13238ms step_avg:167.57ms
step:90/1440 train_loss:4.5723 train_time:13406ms step_avg:167.58ms
step:91/1440 train_loss:4.5673 train_time:13574ms step_avg:167.58ms
step:92/1440 train_loss:4.7184 train_time:13742ms step_avg:167.58ms
step:93/1440 train_loss:4.5516 train_time:13910ms step_avg:167.59ms
step:94/1440 train_loss:4.5917 train_time:14079ms step_avg:167.60ms
step:95/1440 train_loss:4.6269 train_time:14247ms step_avg:167.61ms
step:96/1440 train_loss:4.5285 train_time:14416ms step_avg:167.63ms
step:97/1440 train_loss:4.5798 train_time:14584ms step_avg:167.64ms
step:98/1440 train_loss:4.5362 train_time:14753ms step_avg:167.65ms
step:99/1440 train_loss:4.6048 train_time:14921ms step_avg:167.65ms
step:100/1440 train_loss:4.6217 train_time:15090ms step_avg:167.66ms
step:101/1440 train_loss:4.4975 train_time:15256ms step_avg:167.65ms
step:102/1440 train_loss:4.6566 train_time:15425ms step_avg:167.66ms
step:103/1440 train_loss:4.5187 train_time:15594ms step_avg:167.68ms
step:104/1440 train_loss:4.4952 train_time:15761ms step_avg:167.67ms
step:105/1440 train_loss:4.4989 train_time:15929ms step_avg:167.67ms
step:106/1440 train_loss:4.5245 train_time:16097ms step_avg:167.67ms
step:107/1440 train_loss:4.4566 train_time:16264ms step_avg:167.67ms
step:108/1440 train_loss:4.3055 train_time:16434ms step_avg:167.70ms
step:109/1440 train_loss:4.4240 train_time:16607ms step_avg:167.74ms
step:110/1440 train_loss:4.4058 train_time:16780ms step_avg:167.80ms
step:111/1440 train_loss:4.3456 train_time:16951ms step_avg:167.84ms
step:112/1440 train_loss:4.5205 train_time:17123ms step_avg:167.88ms
step:113/1440 train_loss:4.4193 train_time:17295ms step_avg:167.91ms
step:114/1440 train_loss:4.2908 train_time:17466ms step_avg:167.94ms
step:115/1440 train_loss:4.4356 train_time:17637ms step_avg:167.98ms
step:116/1440 train_loss:4.4088 train_time:17810ms step_avg:168.02ms
step:117/1440 train_loss:4.3137 train_time:17982ms step_avg:168.06ms
step:118/1440 train_loss:4.5357 train_time:18154ms step_avg:168.09ms
step:119/1440 train_loss:4.3980 train_time:18326ms step_avg:168.13ms
step:120/1440 train_loss:4.2695 train_time:18498ms step_avg:168.16ms
step:121/1440 train_loss:4.2452 train_time:18668ms step_avg:168.18ms
step:122/1440 train_loss:4.3981 train_time:18840ms step_avg:168.22ms
step:123/1440 train_loss:4.2370 train_time:19012ms step_avg:168.24ms
step:124/1440 train_loss:4.5182 train_time:19184ms step_avg:168.28ms
step:125/1440 train_loss:4.3872 train_time:19355ms step_avg:168.30ms
step:125/1440 val_loss:4.3415 train_time:19388ms step_avg:168.59ms
step:126/1440 train_loss:4.3626 train_time:19530ms step_avg:168.36ms
step:127/1440 train_loss:4.3812 train_time:19700ms step_avg:168.38ms
step:128/1440 train_loss:4.3323 train_time:19874ms step_avg:168.42ms
step:129/1440 train_loss:4.6450 train_time:20045ms step_avg:168.44ms
step:130/1440 train_loss:4.3042 train_time:20216ms step_avg:168.47ms
step:131/1440 train_loss:4.3465 train_time:20389ms step_avg:168.50ms
step:132/1440 train_loss:4.2883 train_time:20560ms step_avg:168.52ms
step:133/1440 train_loss:4.4052 train_time:20732ms step_avg:168.56ms
step:134/1440 train_loss:4.2142 train_time:20903ms step_avg:168.57ms
step:135/1440 train_loss:4.3910 train_time:21076ms step_avg:168.61ms
step:136/1440 train_loss:4.1540 train_time:21248ms step_avg:168.63ms
step:137/1440 train_loss:4.3235 train_time:21419ms step_avg:168.65ms
step:138/1440 train_loss:4.2394 train_time:21592ms step_avg:168.69ms
step:139/1440 train_loss:4.3352 train_time:21764ms step_avg:168.71ms
step:140/1440 train_loss:4.4299 train_time:21935ms step_avg:168.73ms
step:141/1440 train_loss:4.2613 train_time:22106ms step_avg:168.75ms
step:142/1440 train_loss:4.2566 train_time:22278ms step_avg:168.77ms
step:143/1440 train_loss:4.2004 train_time:22451ms step_avg:168.80ms
step:144/1440 train_loss:4.3055 train_time:22621ms step_avg:168.81ms
step:145/1440 train_loss:4.2741 train_time:22793ms step_avg:168.84ms
step:146/1440 train_loss:4.1395 train_time:22965ms step_avg:168.86ms
step:147/1440 train_loss:4.2751 train_time:23136ms step_avg:168.88ms
step:148/1440 train_loss:4.3066 train_time:23308ms step_avg:168.90ms
step:149/1440 train_loss:4.2519 train_time:23481ms step_avg:168.93ms
step:150/1440 train_loss:4.3972 train_time:23654ms step_avg:168.96ms
step:151/1440 train_loss:4.2208 train_time:23825ms step_avg:168.97ms
step:152/1440 train_loss:4.2181 train_time:23996ms step_avg:168.99ms
step:153/1440 train_loss:4.3245 train_time:24169ms step_avg:169.01ms
step:154/1440 train_loss:4.3256 train_time:24340ms step_avg:169.03ms
step:155/1440 train_loss:4.2184 train_time:24513ms step_avg:169.05ms
step:156/1440 train_loss:4.3066 train_time:24684ms step_avg:169.07ms
step:157/1440 train_loss:4.3548 train_time:24856ms step_avg:169.09ms
step:158/1440 train_loss:4.1975 train_time:25026ms step_avg:169.09ms
step:159/1440 train_loss:4.2563 train_time:25198ms step_avg:169.12ms
step:160/1440 train_loss:4.0838 train_time:25371ms step_avg:169.14ms
step:161/1440 train_loss:4.3013 train_time:25541ms step_avg:169.14ms
step:162/1440 train_loss:4.2987 train_time:25713ms step_avg:169.16ms
step:163/1440 train_loss:4.2750 train_time:25883ms step_avg:169.17ms
step:164/1440 train_loss:4.1442 train_time:26054ms step_avg:169.18ms
step:165/1440 train_loss:4.2265 train_time:26224ms step_avg:169.19ms
step:166/1440 train_loss:4.2806 train_time:26394ms step_avg:169.19ms
step:167/1440 train_loss:4.1382 train_time:26565ms step_avg:169.20ms
step:168/1440 train_loss:4.2157 train_time:26734ms step_avg:169.20ms
step:169/1440 train_loss:4.1011 train_time:26905ms step_avg:169.22ms
step:170/1440 train_loss:3.9688 train_time:27077ms step_avg:169.23ms
step:171/1440 train_loss:4.1446 train_time:27248ms step_avg:169.24ms
step:172/1440 train_loss:4.1571 train_time:27418ms step_avg:169.24ms
step:173/1440 train_loss:4.2150 train_time:27589ms step_avg:169.26ms
step:174/1440 train_loss:4.3645 train_time:27759ms step_avg:169.26ms
step:175/1440 train_loss:4.1918 train_time:27932ms step_avg:169.28ms
step:176/1440 train_loss:4.0488 train_time:28101ms step_avg:169.28ms
step:177/1440 train_loss:4.0147 train_time:28273ms step_avg:169.30ms
step:178/1440 train_loss:4.1290 train_time:28442ms step_avg:169.30ms
step:179/1440 train_loss:4.0741 train_time:28613ms step_avg:169.31ms
step:180/1440 train_loss:4.0616 train_time:28784ms step_avg:169.32ms
step:181/1440 train_loss:4.2449 train_time:28954ms step_avg:169.32ms
step:182/1440 train_loss:4.1064 train_time:29124ms step_avg:169.33ms
step:183/1440 train_loss:4.0833 train_time:29296ms step_avg:169.34ms
step:184/1440 train_loss:4.0844 train_time:29467ms step_avg:169.35ms
step:185/1440 train_loss:4.1668 train_time:29637ms step_avg:169.35ms
step:186/1440 train_loss:4.1405 train_time:29808ms step_avg:169.36ms
step:187/1440 train_loss:4.1803 train_time:29979ms step_avg:169.37ms
step:188/1440 train_loss:4.1319 train_time:30287ms step_avg:170.15ms
step:189/1440 train_loss:4.0775 train_time:30623ms step_avg:171.08ms
step:190/1440 train_loss:4.1520 train_time:30794ms step_avg:171.08ms
step:191/1440 train_loss:4.0336 train_time:30963ms step_avg:171.07ms
step:192/1440 train_loss:3.9888 train_time:31134ms step_avg:171.07ms
step:193/1440 train_loss:4.2081 train_time:31305ms step_avg:171.07ms
step:194/1440 train_loss:4.1324 train_time:31476ms step_avg:171.06ms
step:195/1440 train_loss:4.3052 train_time:31648ms step_avg:171.07ms
step:196/1440 train_loss:4.1265 train_time:31818ms step_avg:171.07ms
step:197/1440 train_loss:4.0043 train_time:31992ms step_avg:171.08ms
step:198/1440 train_loss:4.1444 train_time:32162ms step_avg:171.08ms
step:199/1440 train_loss:4.0025 train_time:32334ms step_avg:171.08ms
step:200/1440 train_loss:4.0780 train_time:32503ms step_avg:171.07ms
step:201/1440 train_loss:3.9545 train_time:32675ms step_avg:171.07ms
step:202/1440 train_loss:4.2065 train_time:32846ms step_avg:171.07ms
step:203/1440 train_loss:4.0214 train_time:33015ms step_avg:171.06ms
step:204/1440 train_loss:4.1574 train_time:33189ms step_avg:171.08ms
step:205/1440 train_loss:4.1984 train_time:33359ms step_avg:171.07ms
step:206/1440 train_loss:3.9009 train_time:33531ms step_avg:171.08ms
step:207/1440 train_loss:4.0378 train_time:33701ms step_avg:171.07ms
step:208/1440 train_loss:4.0656 train_time:33872ms step_avg:171.07ms
step:209/1440 train_loss:4.1970 train_time:34042ms step_avg:171.07ms
step:210/1440 train_loss:4.1357 train_time:34213ms step_avg:171.07ms
step:211/1440 train_loss:4.0189 train_time:34384ms step_avg:171.06ms
step:212/1440 train_loss:4.0781 train_time:34555ms step_avg:171.06ms
step:213/1440 train_loss:4.0041 train_time:34725ms step_avg:171.06ms
step:214/1440 train_loss:4.0677 train_time:34896ms step_avg:171.06ms
step:215/1440 train_loss:3.8902 train_time:35071ms step_avg:171.08ms
step:216/1440 train_loss:3.9376 train_time:35244ms step_avg:171.09ms
step:217/1440 train_loss:3.9548 train_time:35418ms step_avg:171.10ms
step:218/1440 train_loss:4.0402 train_time:35593ms step_avg:171.12ms
step:219/1440 train_loss:4.0237 train_time:35766ms step_avg:171.13ms
step:220/1440 train_loss:4.0324 train_time:35939ms step_avg:171.14ms
step:221/1440 train_loss:4.0442 train_time:36113ms step_avg:171.15ms
step:222/1440 train_loss:3.9480 train_time:36287ms step_avg:171.16ms
step:223/1440 train_loss:3.9228 train_time:36461ms step_avg:171.18ms
step:224/1440 train_loss:4.2442 train_time:36635ms step_avg:171.19ms
step:225/1440 train_loss:3.8631 train_time:36808ms step_avg:171.20ms
step:226/1440 train_loss:3.9397 train_time:36981ms step_avg:171.21ms
step:227/1440 train_loss:3.9282 train_time:37155ms step_avg:171.22ms
step:228/1440 train_loss:4.0906 train_time:37330ms step_avg:171.24ms
step:229/1440 train_loss:3.8787 train_time:37503ms step_avg:171.25ms
step:230/1440 train_loss:3.9963 train_time:37677ms step_avg:171.26ms
step:231/1440 train_loss:3.8553 train_time:37850ms step_avg:171.27ms
step:232/1440 train_loss:3.9210 train_time:38023ms step_avg:171.27ms
step:233/1440 train_loss:4.0301 train_time:38197ms step_avg:171.29ms
step:234/1440 train_loss:3.9804 train_time:38371ms step_avg:171.30ms
step:235/1440 train_loss:3.8525 train_time:38545ms step_avg:171.31ms
step:236/1440 train_loss:4.0279 train_time:38718ms step_avg:171.32ms
step:237/1440 train_loss:4.0394 train_time:38893ms step_avg:171.34ms
step:238/1440 train_loss:3.8920 train_time:39067ms step_avg:171.35ms
step:239/1440 train_loss:4.0248 train_time:39239ms step_avg:171.35ms
step:240/1440 train_loss:4.0702 train_time:39414ms step_avg:171.37ms
step:241/1440 train_loss:3.9203 train_time:39588ms step_avg:171.38ms
step:242/1440 train_loss:4.1078 train_time:39761ms step_avg:171.39ms
step:243/1440 train_loss:3.9734 train_time:39935ms step_avg:171.39ms
step:244/1440 train_loss:4.0455 train_time:40108ms step_avg:171.40ms
step:245/1440 train_loss:4.1070 train_time:40282ms step_avg:171.41ms
step:246/1440 train_loss:4.0157 train_time:40456ms step_avg:171.43ms
step:247/1440 train_loss:3.9628 train_time:40631ms step_avg:171.44ms
step:248/1440 train_loss:4.0501 train_time:40804ms step_avg:171.44ms
step:249/1440 train_loss:3.8724 train_time:40977ms step_avg:171.45ms
step:250/1440 train_loss:3.9287 train_time:41151ms step_avg:171.46ms
step:250/1440 val_loss:3.9610 train_time:41185ms step_avg:171.60ms
step:251/1440 train_loss:4.0280 train_time:41327ms step_avg:171.48ms
step:252/1440 train_loss:4.1268 train_time:41500ms step_avg:171.49ms
step:253/1440 train_loss:3.8809 train_time:41676ms step_avg:171.51ms
step:254/1440 train_loss:3.8414 train_time:41851ms step_avg:171.52ms
step:255/1440 train_loss:4.0319 train_time:42024ms step_avg:171.53ms
step:256/1440 train_loss:3.9338 train_time:42198ms step_avg:171.54ms
step:257/1440 train_loss:3.9472 train_time:42372ms step_avg:171.55ms
step:258/1440 train_loss:3.9529 train_time:42546ms step_avg:171.56ms
step:259/1440 train_loss:3.9969 train_time:42720ms step_avg:171.57ms
step:260/1440 train_loss:4.0160 train_time:42895ms step_avg:171.58ms
step:261/1440 train_loss:3.9805 train_time:43068ms step_avg:171.59ms
step:262/1440 train_loss:3.9595 train_time:43242ms step_avg:171.60ms
step:263/1440 train_loss:3.8490 train_time:43417ms step_avg:171.61ms
step:264/1440 train_loss:3.9532 train_time:43591ms step_avg:171.62ms
step:265/1440 train_loss:3.8313 train_time:43765ms step_avg:171.63ms
step:266/1440 train_loss:3.8855 train_time:43938ms step_avg:171.63ms
step:267/1440 train_loss:3.8941 train_time:44114ms step_avg:171.65ms
step:268/1440 train_loss:3.9162 train_time:44286ms step_avg:171.65ms
step:269/1440 train_loss:3.8047 train_time:44459ms step_avg:171.65ms
step:270/1440 train_loss:4.0448 train_time:44633ms step_avg:171.67ms
step:271/1440 train_loss:3.9231 train_time:44805ms step_avg:171.67ms
step:272/1440 train_loss:3.8937 train_time:44979ms step_avg:171.67ms
step:273/1440 train_loss:3.9109 train_time:45152ms step_avg:171.68ms
step:274/1440 train_loss:3.9918 train_time:45325ms step_avg:171.69ms
step:275/1440 train_loss:4.0108 train_time:45497ms step_avg:171.69ms
step:276/1440 train_loss:4.1722 train_time:45673ms step_avg:171.70ms
step:277/1440 train_loss:3.9839 train_time:45846ms step_avg:171.71ms
step:278/1440 train_loss:4.0298 train_time:46019ms step_avg:171.71ms
step:279/1440 train_loss:3.9495 train_time:46192ms step_avg:171.72ms
step:280/1440 train_loss:4.1515 train_time:46365ms step_avg:171.72ms
step:281/1440 train_loss:3.9216 train_time:46538ms step_avg:171.73ms
step:282/1440 train_loss:3.8874 train_time:46713ms step_avg:171.74ms
step:283/1440 train_loss:3.8689 train_time:46886ms step_avg:171.74ms
step:284/1440 train_loss:3.9967 train_time:47060ms step_avg:171.75ms
step:285/1440 train_loss:4.0150 train_time:47234ms step_avg:171.76ms
step:286/1440 train_loss:4.0453 train_time:47406ms step_avg:171.76ms
step:287/1440 train_loss:3.8606 train_time:47579ms step_avg:171.76ms
step:288/1440 train_loss:3.9669 train_time:47753ms step_avg:171.77ms
step:289/1440 train_loss:3.8413 train_time:47926ms step_avg:171.78ms
step:290/1440 train_loss:3.8157 train_time:48097ms step_avg:171.78ms
step:291/1440 train_loss:3.8638 train_time:48272ms step_avg:171.79ms
step:292/1440 train_loss:3.8103 train_time:48444ms step_avg:171.79ms
step:293/1440 train_loss:3.8540 train_time:48617ms step_avg:171.79ms
step:294/1440 train_loss:3.8948 train_time:48790ms step_avg:171.79ms
step:295/1440 train_loss:3.8018 train_time:48962ms step_avg:171.80ms
step:296/1440 train_loss:3.8293 train_time:49136ms step_avg:171.80ms
step:297/1440 train_loss:3.8347 train_time:49309ms step_avg:171.81ms
step:298/1440 train_loss:3.9384 train_time:49482ms step_avg:171.81ms
step:299/1440 train_loss:3.7823 train_time:49656ms step_avg:171.82ms
step:300/1440 train_loss:3.9237 train_time:49829ms step_avg:171.83ms
step:301/1440 train_loss:3.9202 train_time:50000ms step_avg:171.82ms
step:302/1440 train_loss:3.9003 train_time:50175ms step_avg:171.83ms
step:303/1440 train_loss:3.9352 train_time:50348ms step_avg:171.84ms
step:304/1440 train_loss:3.9273 train_time:50520ms step_avg:171.84ms
step:305/1440 train_loss:4.4112 train_time:50694ms step_avg:171.85ms
step:306/1440 train_loss:3.8987 train_time:50867ms step_avg:171.85ms
step:307/1440 train_loss:3.7924 train_time:51040ms step_avg:171.85ms
step:308/1440 train_loss:3.9309 train_time:51215ms step_avg:171.86ms
step:309/1440 train_loss:3.8310 train_time:51388ms step_avg:171.87ms
step:310/1440 train_loss:4.0423 train_time:51560ms step_avg:171.87ms
step:311/1440 train_loss:3.8870 train_time:51736ms step_avg:171.88ms
step:312/1440 train_loss:3.8289 train_time:51909ms step_avg:171.88ms
step:313/1440 train_loss:3.8849 train_time:52082ms step_avg:171.89ms
step:314/1440 train_loss:4.0218 train_time:52256ms step_avg:171.89ms
step:315/1440 train_loss:3.9014 train_time:52429ms step_avg:171.90ms
step:316/1440 train_loss:3.7483 train_time:52601ms step_avg:171.90ms
step:317/1440 train_loss:3.8285 train_time:52775ms step_avg:171.91ms
step:318/1440 train_loss:3.8869 train_time:52949ms step_avg:171.91ms
step:319/1440 train_loss:3.8546 train_time:53122ms step_avg:171.92ms
step:320/1440 train_loss:3.9690 train_time:53296ms step_avg:171.92ms
step:321/1440 train_loss:3.9036 train_time:53471ms step_avg:171.93ms
step:322/1440 train_loss:3.8909 train_time:53647ms step_avg:171.95ms
step:323/1440 train_loss:3.9616 train_time:53822ms step_avg:171.96ms
step:324/1440 train_loss:3.9007 train_time:53998ms step_avg:171.97ms
step:325/1440 train_loss:3.9690 train_time:54175ms step_avg:171.98ms
step:326/1440 train_loss:3.8475 train_time:54351ms step_avg:172.00ms
step:327/1440 train_loss:4.3646 train_time:54528ms step_avg:172.01ms
step:328/1440 train_loss:4.0336 train_time:54704ms step_avg:172.03ms
step:329/1440 train_loss:3.7572 train_time:54882ms step_avg:172.04ms
step:330/1440 train_loss:3.7020 train_time:55058ms step_avg:172.06ms
step:331/1440 train_loss:3.9324 train_time:55235ms step_avg:172.07ms
step:332/1440 train_loss:3.8735 train_time:55411ms step_avg:172.08ms
step:333/1440 train_loss:3.8453 train_time:55586ms step_avg:172.09ms
step:334/1440 train_loss:3.7978 train_time:55761ms step_avg:172.10ms
step:335/1440 train_loss:3.9650 train_time:55938ms step_avg:172.12ms
step:336/1440 train_loss:3.9222 train_time:56114ms step_avg:172.13ms
step:337/1440 train_loss:4.3705 train_time:56290ms step_avg:172.14ms
step:338/1440 train_loss:3.8911 train_time:56464ms step_avg:172.15ms
step:339/1440 train_loss:3.8127 train_time:56642ms step_avg:172.16ms
step:340/1440 train_loss:3.8871 train_time:56818ms step_avg:172.18ms
step:341/1440 train_loss:3.8131 train_time:56994ms step_avg:172.19ms
step:342/1440 train_loss:3.7684 train_time:57168ms step_avg:172.19ms
step:343/1440 train_loss:3.7914 train_time:57345ms step_avg:172.21ms
step:344/1440 train_loss:3.9512 train_time:57520ms step_avg:172.22ms
step:345/1440 train_loss:3.7686 train_time:57699ms step_avg:172.23ms
step:346/1440 train_loss:3.7252 train_time:57875ms step_avg:172.25ms
step:347/1440 train_loss:3.7449 train_time:58051ms step_avg:172.26ms
step:348/1440 train_loss:3.8128 train_time:58227ms step_avg:172.27ms
step:349/1440 train_loss:3.7872 train_time:58401ms step_avg:172.27ms
step:350/1440 train_loss:3.5334 train_time:58579ms step_avg:172.29ms
step:351/1440 train_loss:3.7837 train_time:58756ms step_avg:172.31ms
step:352/1440 train_loss:4.1204 train_time:58933ms step_avg:172.32ms
step:353/1440 train_loss:3.6216 train_time:59109ms step_avg:172.33ms
step:354/1440 train_loss:3.8912 train_time:59282ms step_avg:172.33ms
step:355/1440 train_loss:3.7489 train_time:59459ms step_avg:172.35ms
step:356/1440 train_loss:3.8385 train_time:59636ms step_avg:172.36ms
step:357/1440 train_loss:3.7095 train_time:59812ms step_avg:172.37ms
step:358/1440 train_loss:3.8234 train_time:59988ms step_avg:172.38ms
step:359/1440 train_loss:3.7362 train_time:60165ms step_avg:172.39ms
step:360/1440 train_loss:3.3824 train_time:60343ms step_avg:172.41ms
step:361/1440 train_loss:3.9649 train_time:60520ms step_avg:172.42ms
step:362/1440 train_loss:3.8677 train_time:60696ms step_avg:172.43ms
step:363/1440 train_loss:3.7944 train_time:60871ms step_avg:172.44ms
step:364/1440 train_loss:3.7077 train_time:61047ms step_avg:172.45ms
step:365/1440 train_loss:3.8696 train_time:61222ms step_avg:172.46ms
step:366/1440 train_loss:3.8178 train_time:61398ms step_avg:172.47ms
step:367/1440 train_loss:3.8183 train_time:61575ms step_avg:172.48ms
step:368/1440 train_loss:3.8158 train_time:61749ms step_avg:172.48ms
step:369/1440 train_loss:3.7063 train_time:61925ms step_avg:172.49ms
step:370/1440 train_loss:3.8342 train_time:62099ms step_avg:172.50ms
step:371/1440 train_loss:3.6849 train_time:62276ms step_avg:172.51ms
step:372/1440 train_loss:3.6565 train_time:62454ms step_avg:172.52ms
step:373/1440 train_loss:3.8718 train_time:62628ms step_avg:172.53ms
step:374/1440 train_loss:3.7897 train_time:62803ms step_avg:172.54ms
step:375/1440 train_loss:3.7503 train_time:62978ms step_avg:172.54ms
step:375/1440 val_loss:3.7817 train_time:63012ms step_avg:172.64ms
step:376/1440 train_loss:3.8212 train_time:63157ms step_avg:172.56ms
step:377/1440 train_loss:3.7540 train_time:63471ms step_avg:172.94ms
step:378/1440 train_loss:3.8076 train_time:63653ms step_avg:172.97ms
step:379/1440 train_loss:3.8247 train_time:63980ms step_avg:173.39ms
step:380/1440 train_loss:3.9148 train_time:64156ms step_avg:173.39ms
step:381/1440 train_loss:3.7891 train_time:64331ms step_avg:173.40ms
step:382/1440 train_loss:3.7496 train_time:64508ms step_avg:173.41ms
step:383/1440 train_loss:3.7650 train_time:64683ms step_avg:173.41ms
step:384/1440 train_loss:3.8311 train_time:64856ms step_avg:173.41ms
step:385/1440 train_loss:3.7483 train_time:65033ms step_avg:173.42ms
step:386/1440 train_loss:3.8429 train_time:65209ms step_avg:173.43ms
step:387/1440 train_loss:4.0016 train_time:65384ms step_avg:173.43ms
step:388/1440 train_loss:3.7493 train_time:65558ms step_avg:173.43ms
step:389/1440 train_loss:3.7579 train_time:65733ms step_avg:173.44ms
step:390/1440 train_loss:3.8486 train_time:65910ms step_avg:173.45ms
step:391/1440 train_loss:3.7737 train_time:66084ms step_avg:173.45ms
step:392/1440 train_loss:3.8781 train_time:66257ms step_avg:173.45ms
step:393/1440 train_loss:3.7235 train_time:66433ms step_avg:173.45ms
step:394/1440 train_loss:3.8520 train_time:66609ms step_avg:173.46ms
step:395/1440 train_loss:3.5920 train_time:66783ms step_avg:173.46ms
step:396/1440 train_loss:3.8013 train_time:66957ms step_avg:173.46ms
step:397/1440 train_loss:3.8140 train_time:67134ms step_avg:173.47ms
step:398/1440 train_loss:3.8296 train_time:67311ms step_avg:173.48ms
step:399/1440 train_loss:3.7341 train_time:67486ms step_avg:173.49ms
step:400/1440 train_loss:3.7852 train_time:67661ms step_avg:173.49ms
step:401/1440 train_loss:3.8760 train_time:67836ms step_avg:173.49ms
step:402/1440 train_loss:3.8007 train_time:68012ms step_avg:173.50ms
step:403/1440 train_loss:3.9203 train_time:68188ms step_avg:173.51ms
step:404/1440 train_loss:3.6404 train_time:68363ms step_avg:173.51ms
step:405/1440 train_loss:3.7520 train_time:68537ms step_avg:173.51ms
step:406/1440 train_loss:4.0591 train_time:68714ms step_avg:173.52ms
step:407/1440 train_loss:3.7379 train_time:68890ms step_avg:173.53ms
step:408/1440 train_loss:3.7815 train_time:69064ms step_avg:173.53ms
step:409/1440 train_loss:3.8140 train_time:69239ms step_avg:173.53ms
step:410/1440 train_loss:3.7189 train_time:69414ms step_avg:173.53ms
step:411/1440 train_loss:3.7184 train_time:69590ms step_avg:173.54ms
step:412/1440 train_loss:4.1438 train_time:69765ms step_avg:173.54ms
step:413/1440 train_loss:3.6303 train_time:69939ms step_avg:173.55ms
step:414/1440 train_loss:3.9673 train_time:70114ms step_avg:173.55ms
step:415/1440 train_loss:3.7137 train_time:70290ms step_avg:173.56ms
step:416/1440 train_loss:3.7263 train_time:70465ms step_avg:173.56ms
step:417/1440 train_loss:3.9238 train_time:70639ms step_avg:173.56ms
step:418/1440 train_loss:3.6545 train_time:70814ms step_avg:173.56ms
step:419/1440 train_loss:3.7734 train_time:70990ms step_avg:173.57ms
step:420/1440 train_loss:3.6648 train_time:71164ms step_avg:173.57ms
step:421/1440 train_loss:3.6181 train_time:71338ms step_avg:173.57ms
step:422/1440 train_loss:3.7474 train_time:71514ms step_avg:173.58ms
step:423/1440 train_loss:3.8360 train_time:71689ms step_avg:173.58ms
step:424/1440 train_loss:3.5716 train_time:71864ms step_avg:173.58ms
step:425/1440 train_loss:3.7531 train_time:72039ms step_avg:173.59ms
step:426/1440 train_loss:3.6126 train_time:72214ms step_avg:173.59ms
step:427/1440 train_loss:3.8527 train_time:72389ms step_avg:173.60ms
step:428/1440 train_loss:3.7660 train_time:72565ms step_avg:173.60ms
step:429/1440 train_loss:3.7165 train_time:72742ms step_avg:173.61ms
step:430/1440 train_loss:3.6706 train_time:72919ms step_avg:173.62ms
step:431/1440 train_loss:3.5872 train_time:73098ms step_avg:173.63ms
step:432/1440 train_loss:3.7310 train_time:73274ms step_avg:173.64ms
step:433/1440 train_loss:3.7747 train_time:73453ms step_avg:173.65ms
step:434/1440 train_loss:3.7368 train_time:73630ms step_avg:173.66ms
step:435/1440 train_loss:3.7652 train_time:73807ms step_avg:173.66ms
step:436/1440 train_loss:3.7856 train_time:73984ms step_avg:173.67ms
step:437/1440 train_loss:3.6759 train_time:74161ms step_avg:173.68ms
step:438/1440 train_loss:3.6592 train_time:74338ms step_avg:173.69ms
step:439/1440 train_loss:3.6720 train_time:74517ms step_avg:173.70ms
step:440/1440 train_loss:3.8535 train_time:74694ms step_avg:173.71ms
step:441/1440 train_loss:3.7152 train_time:74872ms step_avg:173.72ms
step:442/1440 train_loss:3.6952 train_time:75050ms step_avg:173.73ms
step:443/1440 train_loss:3.5833 train_time:75227ms step_avg:173.74ms
step:444/1440 train_loss:3.8815 train_time:75405ms step_avg:173.74ms
step:445/1440 train_loss:3.8034 train_time:75581ms step_avg:173.75ms
step:446/1440 train_loss:3.7894 train_time:75758ms step_avg:173.76ms
step:447/1440 train_loss:3.7164 train_time:75936ms step_avg:173.77ms
step:448/1440 train_loss:3.8140 train_time:76115ms step_avg:173.78ms
step:449/1440 train_loss:3.6522 train_time:76295ms step_avg:173.79ms
step:450/1440 train_loss:3.6817 train_time:76474ms step_avg:173.80ms
step:451/1440 train_loss:3.5388 train_time:76652ms step_avg:173.81ms
step:452/1440 train_loss:3.6749 train_time:76828ms step_avg:173.82ms
step:453/1440 train_loss:3.6326 train_time:77006ms step_avg:173.83ms
step:454/1440 train_loss:3.6012 train_time:77183ms step_avg:173.84ms
step:455/1440 train_loss:3.8037 train_time:77360ms step_avg:173.84ms
step:456/1440 train_loss:3.6895 train_time:77538ms step_avg:173.85ms
step:457/1440 train_loss:3.7431 train_time:77716ms step_avg:173.86ms
step:458/1440 train_loss:3.7845 train_time:77894ms step_avg:173.87ms
step:459/1440 train_loss:3.5999 train_time:78073ms step_avg:173.88ms
step:460/1440 train_loss:3.7599 train_time:78251ms step_avg:173.89ms
step:461/1440 train_loss:3.6632 train_time:78430ms step_avg:173.90ms
step:462/1440 train_loss:3.7127 train_time:78608ms step_avg:173.91ms
step:463/1440 train_loss:3.7328 train_time:78787ms step_avg:173.92ms
step:464/1440 train_loss:3.6704 train_time:78963ms step_avg:173.93ms
step:465/1440 train_loss:3.6806 train_time:79140ms step_avg:173.93ms
step:466/1440 train_loss:3.7630 train_time:79318ms step_avg:173.94ms
step:467/1440 train_loss:3.7820 train_time:79498ms step_avg:173.96ms
step:468/1440 train_loss:3.7560 train_time:79674ms step_avg:173.96ms
step:469/1440 train_loss:3.6471 train_time:79852ms step_avg:173.97ms
step:470/1440 train_loss:3.7336 train_time:80029ms step_avg:173.98ms
step:471/1440 train_loss:3.7732 train_time:80208ms step_avg:173.99ms
step:472/1440 train_loss:3.7495 train_time:80385ms step_avg:173.99ms
step:473/1440 train_loss:3.6736 train_time:80561ms step_avg:174.00ms
step:474/1440 train_loss:3.5504 train_time:80739ms step_avg:174.01ms
step:475/1440 train_loss:3.9838 train_time:80917ms step_avg:174.01ms
step:476/1440 train_loss:3.7178 train_time:81095ms step_avg:174.02ms
step:477/1440 train_loss:3.5591 train_time:81274ms step_avg:174.03ms
step:478/1440 train_loss:3.7906 train_time:81451ms step_avg:174.04ms
step:479/1440 train_loss:3.7339 train_time:81628ms step_avg:174.05ms
step:480/1440 train_loss:3.8819 train_time:81806ms step_avg:174.05ms
step:481/1440 train_loss:3.6804 train_time:81982ms step_avg:174.06ms
step:482/1440 train_loss:3.4914 train_time:82159ms step_avg:174.07ms
step:483/1440 train_loss:3.7655 train_time:82336ms step_avg:174.07ms
step:484/1440 train_loss:3.6186 train_time:82514ms step_avg:174.08ms
step:485/1440 train_loss:3.6169 train_time:82693ms step_avg:174.09ms
step:486/1440 train_loss:3.5245 train_time:82871ms step_avg:174.10ms
step:487/1440 train_loss:3.6434 train_time:83048ms step_avg:174.10ms
step:488/1440 train_loss:3.8407 train_time:83223ms step_avg:174.11ms
step:489/1440 train_loss:3.6733 train_time:83402ms step_avg:174.12ms
step:490/1440 train_loss:3.5536 train_time:83578ms step_avg:174.12ms
step:491/1440 train_loss:3.5807 train_time:83754ms step_avg:174.13ms
step:492/1440 train_loss:3.6870 train_time:83932ms step_avg:174.13ms
step:493/1440 train_loss:3.5349 train_time:84110ms step_avg:174.14ms
step:494/1440 train_loss:3.6628 train_time:84286ms step_avg:174.15ms
step:495/1440 train_loss:3.6173 train_time:84463ms step_avg:174.15ms
step:496/1440 train_loss:3.4613 train_time:84640ms step_avg:174.16ms
step:497/1440 train_loss:3.6916 train_time:84816ms step_avg:174.16ms
step:498/1440 train_loss:3.7486 train_time:84994ms step_avg:174.17ms
step:499/1440 train_loss:3.7823 train_time:85173ms step_avg:174.18ms
step:500/1440 train_loss:3.6919 train_time:85351ms step_avg:174.18ms
step:500/1440 val_loss:3.6650 train_time:85384ms step_avg:174.25ms
step:501/1440 train_loss:3.7668 train_time:85530ms step_avg:174.20ms
step:502/1440 train_loss:3.7110 train_time:85708ms step_avg:174.20ms
step:503/1440 train_loss:3.7340 train_time:85883ms step_avg:174.20ms
step:504/1440 train_loss:3.6798 train_time:86059ms step_avg:174.21ms
step:505/1440 train_loss:3.7601 train_time:86236ms step_avg:174.21ms
step:506/1440 train_loss:3.6245 train_time:86415ms step_avg:174.22ms
step:507/1440 train_loss:3.7267 train_time:86592ms step_avg:174.23ms
step:508/1440 train_loss:3.7880 train_time:86773ms step_avg:174.24ms
step:509/1440 train_loss:3.7310 train_time:86950ms step_avg:174.25ms
step:510/1440 train_loss:3.5399 train_time:87129ms step_avg:174.26ms
step:511/1440 train_loss:3.7460 train_time:87306ms step_avg:174.26ms
step:512/1440 train_loss:3.6828 train_time:87486ms step_avg:174.27ms
step:513/1440 train_loss:3.6298 train_time:87661ms step_avg:174.28ms
step:514/1440 train_loss:3.7772 train_time:87840ms step_avg:174.29ms
step:515/1440 train_loss:3.6953 train_time:88016ms step_avg:174.29ms
step:516/1440 train_loss:4.0292 train_time:88195ms step_avg:174.30ms
step:517/1440 train_loss:3.6512 train_time:88373ms step_avg:174.31ms
step:518/1440 train_loss:3.7240 train_time:88550ms step_avg:174.31ms
step:519/1440 train_loss:3.6093 train_time:88728ms step_avg:174.32ms
step:520/1440 train_loss:3.6401 train_time:88906ms step_avg:174.33ms
step:521/1440 train_loss:3.6328 train_time:89084ms step_avg:174.33ms
step:522/1440 train_loss:3.6191 train_time:89260ms step_avg:174.34ms
step:523/1440 train_loss:4.2434 train_time:89439ms step_avg:174.34ms
step:524/1440 train_loss:3.6982 train_time:89615ms step_avg:174.35ms
step:525/1440 train_loss:3.6401 train_time:89792ms step_avg:174.35ms
step:526/1440 train_loss:3.6548 train_time:89970ms step_avg:174.36ms
step:527/1440 train_loss:3.6215 train_time:90148ms step_avg:174.37ms
step:528/1440 train_loss:3.5995 train_time:90323ms step_avg:174.37ms
step:529/1440 train_loss:3.8190 train_time:90500ms step_avg:174.37ms
step:530/1440 train_loss:3.6183 train_time:90677ms step_avg:174.38ms
step:531/1440 train_loss:3.8756 train_time:90855ms step_avg:174.39ms
step:532/1440 train_loss:3.6911 train_time:91032ms step_avg:174.39ms
step:533/1440 train_loss:3.6126 train_time:91210ms step_avg:174.40ms
step:534/1440 train_loss:3.6373 train_time:91386ms step_avg:174.40ms
step:535/1440 train_loss:3.5635 train_time:91565ms step_avg:174.41ms
step:536/1440 train_loss:3.7147 train_time:91746ms step_avg:174.42ms
step:537/1440 train_loss:3.6848 train_time:91926ms step_avg:174.43ms
step:538/1440 train_loss:3.5856 train_time:92107ms step_avg:174.44ms
step:539/1440 train_loss:4.0759 train_time:92290ms step_avg:174.46ms
step:540/1440 train_loss:3.6357 train_time:92469ms step_avg:174.47ms
step:541/1440 train_loss:3.7536 train_time:92647ms step_avg:174.48ms
step:542/1440 train_loss:3.5473 train_time:92825ms step_avg:174.48ms
step:543/1440 train_loss:3.5475 train_time:93004ms step_avg:174.49ms
step:544/1440 train_loss:3.5963 train_time:93183ms step_avg:174.50ms
step:545/1440 train_loss:3.5533 train_time:93361ms step_avg:174.51ms
step:546/1440 train_loss:3.5833 train_time:93541ms step_avg:174.52ms
step:547/1440 train_loss:3.5973 train_time:93718ms step_avg:174.52ms
step:548/1440 train_loss:3.5603 train_time:93898ms step_avg:174.53ms
step:549/1440 train_loss:3.6830 train_time:94077ms step_avg:174.54ms
step:550/1440 train_loss:3.5759 train_time:94258ms step_avg:174.55ms
step:551/1440 train_loss:3.5924 train_time:94437ms step_avg:174.56ms
step:552/1440 train_loss:3.9008 train_time:94617ms step_avg:174.57ms
step:553/1440 train_loss:3.7279 train_time:94797ms step_avg:174.58ms
step:554/1440 train_loss:3.6835 train_time:94975ms step_avg:174.59ms
step:555/1440 train_loss:3.5844 train_time:95155ms step_avg:174.60ms
step:556/1440 train_loss:3.6605 train_time:95334ms step_avg:174.60ms
step:557/1440 train_loss:3.2652 train_time:95515ms step_avg:174.62ms
step:558/1440 train_loss:3.5745 train_time:95693ms step_avg:174.62ms
step:559/1440 train_loss:3.6116 train_time:95871ms step_avg:174.63ms
step:560/1440 train_loss:3.6513 train_time:96052ms step_avg:174.64ms
step:561/1440 train_loss:3.5736 train_time:96232ms step_avg:174.65ms
step:562/1440 train_loss:3.5228 train_time:96411ms step_avg:174.66ms
step:563/1440 train_loss:3.7186 train_time:96590ms step_avg:174.67ms
step:564/1440 train_loss:3.5347 train_time:96771ms step_avg:174.68ms
step:565/1440 train_loss:3.6434 train_time:96952ms step_avg:174.69ms
step:566/1440 train_loss:3.5831 train_time:97269ms step_avg:174.94ms
step:567/1440 train_loss:3.5663 train_time:97455ms step_avg:174.96ms
step:568/1440 train_loss:3.6491 train_time:97634ms step_avg:174.97ms
step:569/1440 train_loss:3.6117 train_time:97963ms step_avg:175.25ms
step:570/1440 train_loss:3.6501 train_time:98143ms step_avg:175.25ms
step:571/1440 train_loss:3.7241 train_time:98322ms step_avg:175.26ms
step:572/1440 train_loss:3.6882 train_time:98501ms step_avg:175.27ms
step:573/1440 train_loss:3.7010 train_time:98682ms step_avg:175.28ms
step:574/1440 train_loss:3.7371 train_time:98864ms step_avg:175.29ms
step:575/1440 train_loss:3.6949 train_time:99042ms step_avg:175.30ms
step:576/1440 train_loss:3.7288 train_time:99220ms step_avg:175.30ms
step:577/1440 train_loss:3.6374 train_time:99398ms step_avg:175.30ms
step:578/1440 train_loss:3.6420 train_time:99576ms step_avg:175.31ms
step:579/1440 train_loss:3.6422 train_time:99755ms step_avg:175.32ms
step:580/1440 train_loss:3.5479 train_time:99934ms step_avg:175.32ms
step:581/1440 train_loss:3.6026 train_time:100113ms step_avg:175.33ms
step:582/1440 train_loss:3.8124 train_time:100292ms step_avg:175.33ms
step:583/1440 train_loss:3.5925 train_time:100471ms step_avg:175.34ms
step:584/1440 train_loss:3.5520 train_time:100653ms step_avg:175.35ms
step:585/1440 train_loss:3.7568 train_time:100831ms step_avg:175.36ms
step:586/1440 train_loss:3.4800 train_time:101012ms step_avg:175.37ms
step:587/1440 train_loss:3.6299 train_time:101190ms step_avg:175.37ms
step:588/1440 train_loss:3.6075 train_time:101369ms step_avg:175.38ms
step:589/1440 train_loss:3.9552 train_time:101549ms step_avg:175.39ms
step:590/1440 train_loss:3.7398 train_time:101729ms step_avg:175.39ms
step:591/1440 train_loss:3.4754 train_time:101907ms step_avg:175.40ms
step:592/1440 train_loss:3.5031 train_time:102086ms step_avg:175.41ms
step:593/1440 train_loss:3.4578 train_time:102264ms step_avg:175.41ms
step:594/1440 train_loss:3.5101 train_time:102443ms step_avg:175.42ms
step:595/1440 train_loss:3.8867 train_time:102624ms step_avg:175.43ms
step:596/1440 train_loss:3.6057 train_time:102803ms step_avg:175.43ms
step:597/1440 train_loss:3.5511 train_time:102979ms step_avg:175.43ms
step:598/1440 train_loss:3.6205 train_time:103157ms step_avg:175.44ms
step:599/1440 train_loss:3.4420 train_time:103336ms step_avg:175.44ms
step:600/1440 train_loss:3.5586 train_time:103515ms step_avg:175.45ms
step:601/1440 train_loss:3.6113 train_time:103693ms step_avg:175.45ms
step:602/1440 train_loss:3.6355 train_time:103872ms step_avg:175.46ms
step:603/1440 train_loss:3.7465 train_time:104052ms step_avg:175.47ms
step:604/1440 train_loss:3.5700 train_time:104232ms step_avg:175.47ms
step:605/1440 train_loss:3.5712 train_time:104411ms step_avg:175.48ms
step:606/1440 train_loss:3.5326 train_time:104591ms step_avg:175.49ms
step:607/1440 train_loss:3.8003 train_time:104770ms step_avg:175.49ms
step:608/1440 train_loss:3.5996 train_time:104951ms step_avg:175.50ms
step:609/1440 train_loss:3.5792 train_time:105130ms step_avg:175.51ms
step:610/1440 train_loss:3.6650 train_time:105308ms step_avg:175.51ms
step:611/1440 train_loss:3.5609 train_time:105485ms step_avg:175.52ms
step:612/1440 train_loss:3.5333 train_time:105664ms step_avg:175.52ms
step:613/1440 train_loss:3.7265 train_time:105844ms step_avg:175.53ms
step:614/1440 train_loss:3.6569 train_time:106022ms step_avg:175.53ms
step:615/1440 train_loss:3.6731 train_time:106199ms step_avg:175.53ms
step:616/1440 train_loss:3.5987 train_time:106375ms step_avg:175.54ms
step:617/1440 train_loss:3.5104 train_time:106556ms step_avg:175.54ms
step:618/1440 train_loss:3.6556 train_time:106733ms step_avg:175.55ms
step:619/1440 train_loss:3.5112 train_time:106913ms step_avg:175.55ms
step:620/1440 train_loss:3.5484 train_time:107090ms step_avg:175.56ms
step:621/1440 train_loss:3.8914 train_time:107269ms step_avg:175.56ms
step:622/1440 train_loss:3.5374 train_time:107447ms step_avg:175.57ms
step:623/1440 train_loss:3.5623 train_time:107626ms step_avg:175.57ms
step:624/1440 train_loss:3.6543 train_time:107804ms step_avg:175.58ms
step:625/1440 train_loss:3.6595 train_time:107982ms step_avg:175.58ms
step:625/1440 val_loss:3.5840 train_time:108016ms step_avg:175.64ms
step:626/1440 train_loss:3.6981 train_time:108164ms step_avg:175.59ms
step:627/1440 train_loss:3.6802 train_time:108345ms step_avg:175.60ms
step:628/1440 train_loss:3.7343 train_time:108523ms step_avg:175.60ms
step:629/1440 train_loss:3.5671 train_time:108702ms step_avg:175.61ms
step:630/1440 train_loss:3.6886 train_time:108881ms step_avg:175.61ms
step:631/1440 train_loss:3.6999 train_time:109059ms step_avg:175.62ms
step:632/1440 train_loss:3.6095 train_time:109238ms step_avg:175.62ms
step:633/1440 train_loss:3.5695 train_time:109417ms step_avg:175.63ms
step:634/1440 train_loss:3.6587 train_time:109594ms step_avg:175.63ms
step:635/1440 train_loss:3.9138 train_time:109772ms step_avg:175.64ms
step:636/1440 train_loss:3.5153 train_time:109952ms step_avg:175.64ms
step:637/1440 train_loss:3.3174 train_time:110131ms step_avg:175.65ms
step:638/1440 train_loss:3.5632 train_time:110310ms step_avg:175.65ms
step:639/1440 train_loss:3.6088 train_time:110489ms step_avg:175.66ms
step:640/1440 train_loss:3.5326 train_time:110668ms step_avg:175.66ms
step:641/1440 train_loss:3.5515 train_time:110847ms step_avg:175.67ms
step:642/1440 train_loss:3.5941 train_time:111027ms step_avg:175.68ms
step:643/1440 train_loss:3.5543 train_time:111209ms step_avg:175.69ms
step:644/1440 train_loss:3.5235 train_time:111389ms step_avg:175.69ms
step:645/1440 train_loss:3.7391 train_time:111571ms step_avg:175.70ms
step:646/1440 train_loss:3.6394 train_time:111752ms step_avg:175.71ms
step:647/1440 train_loss:3.6287 train_time:111932ms step_avg:175.72ms
step:648/1440 train_loss:3.6831 train_time:112117ms step_avg:175.73ms
step:649/1440 train_loss:3.7346 train_time:112297ms step_avg:175.74ms
step:650/1440 train_loss:3.5873 train_time:112479ms step_avg:175.75ms
step:651/1440 train_loss:3.7275 train_time:112661ms step_avg:175.76ms
step:652/1440 train_loss:3.5472 train_time:112841ms step_avg:175.77ms
step:653/1440 train_loss:3.6281 train_time:113021ms step_avg:175.77ms
step:654/1440 train_loss:3.3939 train_time:113203ms step_avg:175.78ms
step:655/1440 train_loss:3.5461 train_time:113382ms step_avg:175.79ms
step:656/1440 train_loss:3.5380 train_time:113561ms step_avg:175.79ms
step:657/1440 train_loss:3.4641 train_time:113743ms step_avg:175.80ms
step:658/1440 train_loss:3.6471 train_time:113923ms step_avg:175.81ms
step:659/1440 train_loss:3.5485 train_time:114103ms step_avg:175.81ms
step:660/1440 train_loss:3.6524 train_time:114286ms step_avg:175.82ms
step:661/1440 train_loss:3.7161 train_time:114469ms step_avg:175.84ms
step:662/1440 train_loss:3.6375 train_time:114648ms step_avg:175.84ms
step:663/1440 train_loss:3.5210 train_time:114827ms step_avg:175.85ms
step:664/1440 train_loss:3.5680 train_time:115009ms step_avg:175.85ms
step:665/1440 train_loss:3.4580 train_time:115192ms step_avg:175.87ms
step:666/1440 train_loss:3.7427 train_time:115372ms step_avg:175.87ms
step:667/1440 train_loss:3.5774 train_time:115555ms step_avg:175.88ms
step:668/1440 train_loss:3.6139 train_time:115737ms step_avg:175.89ms
step:669/1440 train_loss:3.4488 train_time:115919ms step_avg:175.90ms
step:670/1440 train_loss:3.5631 train_time:116099ms step_avg:175.91ms
step:671/1440 train_loss:3.5257 train_time:116280ms step_avg:175.92ms
step:672/1440 train_loss:3.5279 train_time:116461ms step_avg:175.92ms
step:673/1440 train_loss:3.8105 train_time:116641ms step_avg:175.93ms
step:674/1440 train_loss:3.5926 train_time:116822ms step_avg:175.94ms
step:675/1440 train_loss:3.6768 train_time:117004ms step_avg:175.95ms
step:676/1440 train_loss:3.4596 train_time:117186ms step_avg:175.96ms
step:677/1440 train_loss:3.5650 train_time:117367ms step_avg:175.96ms
step:678/1440 train_loss:3.5203 train_time:117547ms step_avg:175.97ms
step:679/1440 train_loss:3.6420 train_time:117731ms step_avg:175.98ms
step:680/1440 train_loss:3.5542 train_time:117913ms step_avg:175.99ms
step:681/1440 train_loss:3.5851 train_time:118092ms step_avg:175.99ms
step:682/1440 train_loss:3.6320 train_time:118275ms step_avg:176.00ms
step:683/1440 train_loss:3.6991 train_time:118457ms step_avg:176.01ms
step:684/1440 train_loss:3.6138 train_time:118637ms step_avg:176.02ms
step:685/1440 train_loss:3.6488 train_time:118818ms step_avg:176.03ms
step:686/1440 train_loss:3.6009 train_time:118997ms step_avg:176.03ms
step:687/1440 train_loss:3.6346 train_time:119178ms step_avg:176.04ms
step:688/1440 train_loss:3.1550 train_time:119363ms step_avg:176.05ms
step:689/1440 train_loss:3.3691 train_time:119546ms step_avg:176.06ms
step:690/1440 train_loss:3.5041 train_time:119728ms step_avg:176.07ms
step:691/1440 train_loss:3.3747 train_time:119908ms step_avg:176.08ms
step:692/1440 train_loss:3.5890 train_time:120089ms step_avg:176.08ms
step:693/1440 train_loss:3.6087 train_time:120271ms step_avg:176.09ms
step:694/1440 train_loss:3.5189 train_time:120450ms step_avg:176.10ms
step:695/1440 train_loss:3.5077 train_time:120628ms step_avg:176.10ms
step:696/1440 train_loss:3.8186 train_time:120809ms step_avg:176.11ms
step:697/1440 train_loss:3.5528 train_time:120991ms step_avg:176.11ms
step:698/1440 train_loss:3.6094 train_time:121169ms step_avg:176.12ms
step:699/1440 train_loss:3.7290 train_time:121351ms step_avg:176.13ms
step:700/1440 train_loss:3.5339 train_time:121530ms step_avg:176.13ms
step:701/1440 train_loss:3.5156 train_time:121709ms step_avg:176.13ms
step:702/1440 train_loss:3.4808 train_time:121889ms step_avg:176.14ms
step:703/1440 train_loss:3.4660 train_time:122069ms step_avg:176.15ms
step:704/1440 train_loss:3.5379 train_time:122249ms step_avg:176.15ms
step:705/1440 train_loss:3.5219 train_time:122431ms step_avg:176.16ms
step:706/1440 train_loss:3.5463 train_time:122613ms step_avg:176.17ms
step:707/1440 train_loss:3.6147 train_time:122794ms step_avg:176.17ms
step:708/1440 train_loss:3.5722 train_time:122974ms step_avg:176.18ms
step:709/1440 train_loss:3.5486 train_time:123155ms step_avg:176.19ms
step:710/1440 train_loss:3.5031 train_time:123333ms step_avg:176.19ms
step:711/1440 train_loss:3.5581 train_time:123515ms step_avg:176.20ms
step:712/1440 train_loss:3.6142 train_time:123697ms step_avg:176.21ms
step:713/1440 train_loss:3.6140 train_time:123881ms step_avg:176.22ms
step:714/1440 train_loss:3.5242 train_time:124061ms step_avg:176.22ms
step:715/1440 train_loss:3.5384 train_time:124240ms step_avg:176.23ms
step:716/1440 train_loss:3.5535 train_time:124418ms step_avg:176.23ms
step:717/1440 train_loss:3.6679 train_time:124601ms step_avg:176.24ms
step:718/1440 train_loss:3.5590 train_time:124780ms step_avg:176.24ms
step:719/1440 train_loss:3.6448 train_time:124960ms step_avg:176.25ms
step:720/1440 train_loss:3.8118 train_time:125143ms step_avg:176.26ms
step:721/1440 train_loss:3.4294 train_time:125322ms step_avg:176.26ms
step:722/1440 train_loss:3.7001 train_time:125503ms step_avg:176.27ms
step:723/1440 train_loss:3.7353 train_time:125683ms step_avg:176.27ms
step:724/1440 train_loss:3.5368 train_time:125862ms step_avg:176.28ms
step:725/1440 train_loss:3.6166 train_time:126042ms step_avg:176.28ms
step:726/1440 train_loss:3.4941 train_time:126223ms step_avg:176.29ms
step:727/1440 train_loss:3.5454 train_time:126405ms step_avg:176.30ms
step:728/1440 train_loss:3.6979 train_time:126586ms step_avg:176.30ms
step:729/1440 train_loss:3.6292 train_time:126767ms step_avg:176.31ms
step:730/1440 train_loss:3.6253 train_time:126948ms step_avg:176.32ms
step:731/1440 train_loss:3.5264 train_time:127128ms step_avg:176.32ms
step:732/1440 train_loss:3.5573 train_time:127307ms step_avg:176.33ms
step:733/1440 train_loss:3.7948 train_time:127488ms step_avg:176.33ms
step:734/1440 train_loss:3.5271 train_time:127669ms step_avg:176.34ms
step:735/1440 train_loss:3.5784 train_time:127849ms step_avg:176.34ms
step:736/1440 train_loss:3.7082 train_time:128029ms step_avg:176.35ms
step:737/1440 train_loss:3.6395 train_time:128207ms step_avg:176.35ms
step:738/1440 train_loss:3.5654 train_time:128387ms step_avg:176.36ms
step:739/1440 train_loss:3.4777 train_time:128568ms step_avg:176.36ms
step:740/1440 train_loss:4.0715 train_time:128754ms step_avg:176.38ms
step:741/1440 train_loss:3.4551 train_time:128933ms step_avg:176.38ms
step:742/1440 train_loss:3.5167 train_time:129114ms step_avg:176.39ms
step:743/1440 train_loss:3.5461 train_time:129293ms step_avg:176.39ms
step:744/1440 train_loss:3.6179 train_time:129475ms step_avg:176.40ms
step:745/1440 train_loss:3.5504 train_time:129659ms step_avg:176.41ms
step:746/1440 train_loss:3.5639 train_time:129837ms step_avg:176.41ms
step:747/1440 train_loss:3.6161 train_time:130019ms step_avg:176.42ms
step:748/1440 train_loss:3.5332 train_time:130206ms step_avg:176.43ms
step:749/1440 train_loss:3.5279 train_time:130389ms step_avg:176.44ms
step:750/1440 train_loss:3.5614 train_time:130569ms step_avg:176.44ms
step:750/1440 val_loss:3.5292 train_time:130606ms step_avg:176.49ms
step:751/1440 train_loss:3.5326 train_time:130756ms step_avg:176.46ms
step:752/1440 train_loss:3.5860 train_time:130935ms step_avg:176.46ms
step:753/1440 train_loss:3.5807 train_time:131119ms step_avg:176.47ms
step:754/1440 train_loss:3.5581 train_time:131302ms step_avg:176.48ms
step:755/1440 train_loss:3.6496 train_time:131619ms step_avg:176.67ms
step:756/1440 train_loss:3.4301 train_time:131813ms step_avg:176.69ms
step:757/1440 train_loss:3.6933 train_time:131999ms step_avg:176.71ms
step:758/1440 train_loss:3.6165 train_time:132180ms step_avg:176.71ms
step:759/1440 train_loss:3.5581 train_time:132508ms step_avg:176.91ms
step:760/1440 train_loss:3.6710 train_time:132689ms step_avg:176.92ms
step:761/1440 train_loss:3.3693 train_time:132872ms step_avg:176.93ms
step:762/1440 train_loss:3.5110 train_time:133055ms step_avg:176.93ms
step:763/1440 train_loss:3.6245 train_time:133238ms step_avg:176.94ms
step:764/1440 train_loss:3.2839 train_time:133421ms step_avg:176.95ms
step:765/1440 train_loss:3.7017 train_time:133604ms step_avg:176.96ms
step:766/1440 train_loss:3.5334 train_time:133791ms step_avg:176.97ms
step:767/1440 train_loss:3.5359 train_time:133974ms step_avg:176.98ms
step:768/1440 train_loss:3.5338 train_time:134157ms step_avg:176.99ms
step:769/1440 train_loss:3.5540 train_time:134340ms step_avg:177.00ms
step:770/1440 train_loss:3.6013 train_time:134521ms step_avg:177.00ms
step:771/1440 train_loss:3.8454 train_time:134704ms step_avg:177.01ms
step:772/1440 train_loss:3.4170 train_time:134886ms step_avg:177.02ms
step:773/1440 train_loss:3.5878 train_time:135068ms step_avg:177.02ms
step:774/1440 train_loss:3.6074 train_time:135249ms step_avg:177.03ms
step:775/1440 train_loss:3.5677 train_time:135429ms step_avg:177.03ms
step:776/1440 train_loss:3.3599 train_time:135613ms step_avg:177.04ms
step:777/1440 train_loss:3.3489 train_time:135798ms step_avg:177.05ms
step:778/1440 train_loss:3.4594 train_time:135979ms step_avg:177.06ms
step:779/1440 train_loss:3.5467 train_time:136161ms step_avg:177.06ms
step:780/1440 train_loss:3.5489 train_time:136342ms step_avg:177.07ms
step:781/1440 train_loss:3.6343 train_time:136524ms step_avg:177.07ms
step:782/1440 train_loss:3.5542 train_time:136705ms step_avg:177.08ms
step:783/1440 train_loss:3.5332 train_time:136885ms step_avg:177.08ms
step:784/1440 train_loss:3.5831 train_time:137069ms step_avg:177.09ms
step:785/1440 train_loss:3.5220 train_time:137249ms step_avg:177.10ms
step:786/1440 train_loss:3.4026 train_time:137432ms step_avg:177.10ms
step:787/1440 train_loss:3.6907 train_time:137614ms step_avg:177.11ms
step:788/1440 train_loss:3.4741 train_time:137799ms step_avg:177.12ms
step:789/1440 train_loss:3.5196 train_time:137979ms step_avg:177.12ms
step:790/1440 train_loss:3.5944 train_time:138163ms step_avg:177.13ms
step:791/1440 train_loss:3.7420 train_time:138345ms step_avg:177.14ms
step:792/1440 train_loss:3.7190 train_time:138529ms step_avg:177.15ms
step:793/1440 train_loss:3.4297 train_time:138709ms step_avg:177.15ms
step:794/1440 train_loss:3.5614 train_time:138893ms step_avg:177.16ms
step:795/1440 train_loss:3.6368 train_time:139079ms step_avg:177.17ms
step:796/1440 train_loss:3.7080 train_time:139266ms step_avg:177.18ms
step:797/1440 train_loss:3.4902 train_time:139446ms step_avg:177.19ms
step:798/1440 train_loss:3.6098 train_time:139632ms step_avg:177.20ms
step:799/1440 train_loss:3.5008 train_time:139818ms step_avg:177.21ms
step:800/1440 train_loss:3.4940 train_time:140000ms step_avg:177.22ms
step:801/1440 train_loss:3.5965 train_time:140181ms step_avg:177.22ms
step:802/1440 train_loss:3.4637 train_time:140367ms step_avg:177.23ms
step:803/1440 train_loss:3.4722 train_time:140545ms step_avg:177.23ms
step:804/1440 train_loss:3.5888 train_time:140727ms step_avg:177.24ms
step:805/1440 train_loss:3.4796 train_time:140910ms step_avg:177.25ms
step:806/1440 train_loss:3.5256 train_time:141090ms step_avg:177.25ms
step:807/1440 train_loss:3.6103 train_time:141271ms step_avg:177.25ms
step:808/1440 train_loss:3.5045 train_time:141454ms step_avg:177.26ms
step:809/1440 train_loss:3.4561 train_time:141635ms step_avg:177.27ms
step:810/1440 train_loss:3.5239 train_time:141814ms step_avg:177.27ms
step:811/1440 train_loss:3.5435 train_time:141997ms step_avg:177.27ms
step:812/1440 train_loss:3.5580 train_time:142178ms step_avg:177.28ms
step:813/1440 train_loss:3.5937 train_time:142358ms step_avg:177.28ms
step:814/1440 train_loss:3.5281 train_time:142539ms step_avg:177.29ms
step:815/1440 train_loss:3.5269 train_time:142719ms step_avg:177.29ms
step:816/1440 train_loss:3.6468 train_time:142902ms step_avg:177.30ms
step:817/1440 train_loss:3.7324 train_time:143083ms step_avg:177.30ms
step:818/1440 train_loss:3.4810 train_time:143263ms step_avg:177.31ms
step:819/1440 train_loss:3.6795 train_time:143443ms step_avg:177.31ms
step:820/1440 train_loss:3.4562 train_time:143627ms step_avg:177.32ms
step:821/1440 train_loss:3.5246 train_time:143806ms step_avg:177.32ms
step:822/1440 train_loss:3.6603 train_time:143988ms step_avg:177.33ms
step:823/1440 train_loss:3.5357 train_time:144169ms step_avg:177.33ms
step:824/1440 train_loss:3.4796 train_time:144350ms step_avg:177.33ms
step:825/1440 train_loss:3.5771 train_time:144534ms step_avg:177.34ms
step:826/1440 train_loss:3.4357 train_time:144718ms step_avg:177.35ms
step:827/1440 train_loss:3.6884 train_time:144900ms step_avg:177.36ms
step:828/1440 train_loss:3.5811 train_time:145081ms step_avg:177.36ms
step:829/1440 train_loss:3.5741 train_time:145265ms step_avg:177.37ms
step:830/1440 train_loss:3.4970 train_time:145446ms step_avg:177.37ms
step:831/1440 train_loss:3.5617 train_time:145627ms step_avg:177.38ms
step:832/1440 train_loss:3.4773 train_time:145809ms step_avg:177.38ms
step:833/1440 train_loss:3.6129 train_time:145993ms step_avg:177.39ms
step:834/1440 train_loss:3.4294 train_time:146176ms step_avg:177.40ms
step:835/1440 train_loss:3.4188 train_time:146356ms step_avg:177.40ms
step:836/1440 train_loss:3.6678 train_time:146539ms step_avg:177.41ms
step:837/1440 train_loss:3.3542 train_time:146721ms step_avg:177.41ms
step:838/1440 train_loss:3.5516 train_time:146903ms step_avg:177.42ms
step:839/1440 train_loss:3.3748 train_time:147084ms step_avg:177.42ms
step:840/1440 train_loss:3.4283 train_time:147264ms step_avg:177.43ms
step:841/1440 train_loss:3.5232 train_time:147445ms step_avg:177.43ms
step:842/1440 train_loss:3.5433 train_time:147627ms step_avg:177.44ms
step:843/1440 train_loss:3.5227 train_time:147807ms step_avg:177.44ms
step:844/1440 train_loss:3.3921 train_time:147987ms step_avg:177.44ms
step:845/1440 train_loss:3.6174 train_time:148169ms step_avg:177.45ms
step:846/1440 train_loss:3.4728 train_time:148353ms step_avg:177.46ms
step:847/1440 train_loss:3.4539 train_time:148535ms step_avg:177.46ms
step:848/1440 train_loss:3.6011 train_time:148715ms step_avg:177.46ms
step:849/1440 train_loss:3.4498 train_time:148897ms step_avg:177.47ms
step:850/1440 train_loss:3.3999 train_time:149080ms step_avg:177.48ms
step:851/1440 train_loss:3.6868 train_time:149262ms step_avg:177.48ms
step:852/1440 train_loss:3.4005 train_time:149443ms step_avg:177.49ms
step:853/1440 train_loss:3.5214 train_time:149623ms step_avg:177.49ms
step:854/1440 train_loss:3.6106 train_time:149804ms step_avg:177.49ms
step:855/1440 train_loss:3.4674 train_time:149987ms step_avg:177.50ms
step:856/1440 train_loss:3.5045 train_time:150168ms step_avg:177.50ms
step:857/1440 train_loss:3.5647 train_time:150352ms step_avg:177.51ms
step:858/1440 train_loss:3.4289 train_time:150540ms step_avg:177.52ms
step:859/1440 train_loss:3.5109 train_time:150724ms step_avg:177.53ms
step:860/1440 train_loss:3.5397 train_time:150905ms step_avg:177.54ms
step:861/1440 train_loss:3.5751 train_time:151095ms step_avg:177.55ms
step:862/1440 train_loss:3.5632 train_time:151283ms step_avg:177.56ms
step:863/1440 train_loss:3.5247 train_time:151469ms step_avg:177.57ms
step:864/1440 train_loss:3.3355 train_time:151652ms step_avg:177.58ms
step:865/1440 train_loss:3.5537 train_time:151833ms step_avg:177.58ms
step:866/1440 train_loss:3.8326 train_time:152023ms step_avg:177.60ms
step:867/1440 train_loss:3.4130 train_time:152204ms step_avg:177.60ms
step:868/1440 train_loss:3.6037 train_time:152386ms step_avg:177.61ms
step:869/1440 train_loss:3.5697 train_time:152570ms step_avg:177.61ms
step:870/1440 train_loss:3.4048 train_time:152756ms step_avg:177.62ms
step:871/1440 train_loss:3.3500 train_time:152939ms step_avg:177.63ms
step:872/1440 train_loss:3.5923 train_time:153123ms step_avg:177.64ms
step:873/1440 train_loss:3.4162 train_time:153305ms step_avg:177.64ms
step:874/1440 train_loss:3.1868 train_time:153494ms step_avg:177.66ms
step:875/1440 train_loss:3.5806 train_time:153677ms step_avg:177.66ms
step:875/1440 val_loss:3.4711 train_time:153711ms step_avg:177.70ms
step:876/1440 train_loss:3.3967 train_time:153857ms step_avg:177.66ms
step:877/1440 train_loss:3.5670 train_time:154041ms step_avg:177.67ms
step:878/1440 train_loss:3.4180 train_time:154225ms step_avg:177.68ms
step:879/1440 train_loss:3.6019 train_time:154409ms step_avg:177.69ms
step:880/1440 train_loss:3.2629 train_time:154591ms step_avg:177.69ms
step:881/1440 train_loss:3.4325 train_time:154775ms step_avg:177.70ms
step:882/1440 train_loss:3.6475 train_time:154959ms step_avg:177.71ms
step:883/1440 train_loss:3.7891 train_time:155143ms step_avg:177.71ms
step:884/1440 train_loss:3.5130 train_time:155330ms step_avg:177.72ms
step:885/1440 train_loss:3.4501 train_time:155514ms step_avg:177.73ms
step:886/1440 train_loss:3.5247 train_time:155698ms step_avg:177.74ms
step:887/1440 train_loss:4.0311 train_time:155884ms step_avg:177.75ms
step:888/1440 train_loss:3.7788 train_time:156078ms step_avg:177.77ms
step:889/1440 train_loss:3.4674 train_time:156258ms step_avg:177.77ms
step:890/1440 train_loss:3.4836 train_time:156440ms step_avg:177.77ms
step:891/1440 train_loss:3.3096 train_time:156623ms step_avg:177.78ms
step:892/1440 train_loss:3.6647 train_time:156805ms step_avg:177.78ms
step:893/1440 train_loss:3.3707 train_time:156987ms step_avg:177.79ms
step:894/1440 train_loss:3.5786 train_time:157174ms step_avg:177.80ms
step:895/1440 train_loss:3.6241 train_time:157355ms step_avg:177.80ms
step:896/1440 train_loss:3.4490 train_time:157538ms step_avg:177.81ms
step:897/1440 train_loss:3.4899 train_time:157724ms step_avg:177.82ms
step:898/1440 train_loss:3.5414 train_time:157910ms step_avg:177.83ms
step:899/1440 train_loss:3.4254 train_time:158092ms step_avg:177.83ms
step:900/1440 train_loss:3.3763 train_time:158275ms step_avg:177.84ms
step:901/1440 train_loss:3.5637 train_time:158458ms step_avg:177.84ms
step:902/1440 train_loss:3.5840 train_time:158640ms step_avg:177.85ms
step:903/1440 train_loss:3.4913 train_time:158826ms step_avg:177.86ms
step:904/1440 train_loss:3.4430 train_time:159011ms step_avg:177.86ms
step:905/1440 train_loss:3.4539 train_time:159191ms step_avg:177.87ms
step:906/1440 train_loss:3.6490 train_time:159378ms step_avg:177.88ms
step:907/1440 train_loss:3.4622 train_time:159562ms step_avg:177.88ms
step:908/1440 train_loss:3.5138 train_time:159741ms step_avg:177.89ms
step:909/1440 train_loss:3.4013 train_time:159926ms step_avg:177.89ms
step:910/1440 train_loss:3.4761 train_time:160113ms step_avg:177.90ms
step:911/1440 train_loss:3.5929 train_time:160296ms step_avg:177.91ms
step:912/1440 train_loss:3.5366 train_time:160479ms step_avg:177.91ms
step:913/1440 train_loss:3.3949 train_time:160663ms step_avg:177.92ms
step:914/1440 train_loss:3.6882 train_time:160849ms step_avg:177.93ms
step:915/1440 train_loss:3.4755 train_time:161034ms step_avg:177.94ms
step:916/1440 train_loss:3.5625 train_time:161217ms step_avg:177.94ms
step:917/1440 train_loss:3.5423 train_time:161398ms step_avg:177.95ms
step:918/1440 train_loss:4.7809 train_time:161586ms step_avg:177.96ms
step:919/1440 train_loss:3.4410 train_time:161773ms step_avg:177.97ms
step:920/1440 train_loss:3.5391 train_time:161953ms step_avg:177.97ms
step:921/1440 train_loss:3.5002 train_time:162139ms step_avg:177.98ms
step:922/1440 train_loss:3.5261 train_time:162322ms step_avg:177.99ms
step:923/1440 train_loss:3.5534 train_time:162505ms step_avg:177.99ms
step:924/1440 train_loss:3.6253 train_time:162689ms step_avg:178.00ms
step:925/1440 train_loss:3.5931 train_time:162872ms step_avg:178.00ms
step:926/1440 train_loss:3.4976 train_time:163053ms step_avg:178.01ms
step:927/1440 train_loss:3.4980 train_time:163234ms step_avg:178.01ms
step:928/1440 train_loss:3.7246 train_time:163418ms step_avg:178.01ms
step:929/1440 train_loss:3.5534 train_time:163600ms step_avg:178.02ms
step:930/1440 train_loss:3.3493 train_time:163783ms step_avg:178.03ms
step:931/1440 train_loss:3.4438 train_time:163964ms step_avg:178.03ms
step:932/1440 train_loss:3.5860 train_time:164148ms step_avg:178.03ms
step:933/1440 train_loss:3.3145 train_time:164331ms step_avg:178.04ms
step:934/1440 train_loss:3.5282 train_time:164515ms step_avg:178.05ms
step:935/1440 train_loss:3.3836 train_time:164700ms step_avg:178.05ms
step:936/1440 train_loss:3.4635 train_time:164884ms step_avg:178.06ms
step:937/1440 train_loss:3.5732 train_time:165067ms step_avg:178.07ms
step:938/1440 train_loss:3.4879 train_time:165248ms step_avg:178.07ms
step:939/1440 train_loss:3.6007 train_time:165437ms step_avg:178.08ms
step:940/1440 train_loss:3.4193 train_time:165617ms step_avg:178.08ms
step:941/1440 train_loss:3.4855 train_time:165800ms step_avg:178.09ms
step:942/1440 train_loss:3.3006 train_time:165981ms step_avg:178.09ms
step:943/1440 train_loss:3.6557 train_time:166165ms step_avg:178.10ms
step:944/1440 train_loss:3.3441 train_time:166487ms step_avg:178.25ms
step:945/1440 train_loss:3.3663 train_time:166674ms step_avg:178.26ms
step:946/1440 train_loss:5.0207 train_time:166862ms step_avg:178.27ms
step:947/1440 train_loss:3.5461 train_time:167045ms step_avg:178.28ms
step:948/1440 train_loss:3.4262 train_time:167227ms step_avg:178.28ms
step:949/1440 train_loss:3.3104 train_time:167558ms step_avg:178.44ms
step:950/1440 train_loss:3.3826 train_time:167740ms step_avg:178.45ms
step:951/1440 train_loss:3.3459 train_time:167924ms step_avg:178.45ms
step:952/1440 train_loss:3.4222 train_time:168108ms step_avg:178.46ms
step:953/1440 train_loss:3.5127 train_time:168292ms step_avg:178.46ms
step:954/1440 train_loss:3.4004 train_time:168475ms step_avg:178.47ms
step:955/1440 train_loss:3.4226 train_time:168656ms step_avg:178.47ms
step:956/1440 train_loss:3.3876 train_time:168841ms step_avg:178.48ms
step:957/1440 train_loss:3.4327 train_time:169027ms step_avg:178.49ms
step:958/1440 train_loss:3.4511 train_time:169212ms step_avg:178.49ms
step:959/1440 train_loss:3.4572 train_time:169397ms step_avg:178.50ms
step:960/1440 train_loss:3.3504 train_time:169581ms step_avg:178.51ms
step:961/1440 train_loss:3.5821 train_time:169765ms step_avg:178.51ms
step:962/1440 train_loss:3.5347 train_time:169947ms step_avg:178.52ms
step:963/1440 train_loss:3.5790 train_time:170134ms step_avg:178.52ms
step:964/1440 train_loss:3.3724 train_time:170322ms step_avg:178.53ms
step:965/1440 train_loss:3.4280 train_time:170503ms step_avg:178.54ms
step:966/1440 train_loss:3.6503 train_time:170690ms step_avg:178.55ms
step:967/1440 train_loss:3.4658 train_time:170873ms step_avg:178.55ms
step:968/1440 train_loss:3.4549 train_time:171058ms step_avg:178.56ms
step:969/1440 train_loss:3.5278 train_time:171245ms step_avg:178.57ms
step:970/1440 train_loss:3.3184 train_time:171426ms step_avg:178.57ms
step:971/1440 train_loss:3.4761 train_time:171611ms step_avg:178.58ms
step:972/1440 train_loss:3.4042 train_time:171793ms step_avg:178.58ms
step:973/1440 train_loss:3.4837 train_time:171976ms step_avg:178.58ms
step:974/1440 train_loss:3.5205 train_time:172163ms step_avg:178.59ms
step:975/1440 train_loss:3.4081 train_time:172349ms step_avg:178.60ms
step:976/1440 train_loss:3.6072 train_time:172533ms step_avg:178.61ms
step:977/1440 train_loss:3.5195 train_time:172716ms step_avg:178.61ms
step:978/1440 train_loss:3.2940 train_time:172902ms step_avg:178.62ms
step:979/1440 train_loss:3.5567 train_time:173088ms step_avg:178.63ms
step:980/1440 train_loss:3.3642 train_time:173276ms step_avg:178.63ms
step:981/1440 train_loss:3.5175 train_time:173460ms step_avg:178.64ms
step:982/1440 train_loss:3.4829 train_time:173646ms step_avg:178.65ms
step:983/1440 train_loss:3.4440 train_time:173834ms step_avg:178.66ms
step:984/1440 train_loss:3.4423 train_time:174018ms step_avg:178.66ms
step:985/1440 train_loss:3.5193 train_time:174206ms step_avg:178.67ms
step:986/1440 train_loss:3.3620 train_time:174392ms step_avg:178.68ms
step:987/1440 train_loss:3.4311 train_time:174573ms step_avg:178.68ms
step:988/1440 train_loss:3.4202 train_time:174757ms step_avg:178.69ms
step:989/1440 train_loss:3.3570 train_time:174939ms step_avg:178.69ms
step:990/1440 train_loss:3.6097 train_time:175128ms step_avg:178.70ms
step:991/1440 train_loss:3.4165 train_time:175313ms step_avg:178.71ms
step:992/1440 train_loss:3.3983 train_time:175506ms step_avg:178.72ms
step:993/1440 train_loss:3.4391 train_time:175697ms step_avg:178.74ms
step:994/1440 train_loss:3.5412 train_time:175880ms step_avg:178.74ms
step:995/1440 train_loss:3.4745 train_time:176061ms step_avg:178.74ms
step:996/1440 train_loss:3.4051 train_time:176244ms step_avg:178.75ms
step:997/1440 train_loss:3.6917 train_time:176429ms step_avg:178.75ms
step:998/1440 train_loss:3.3834 train_time:176611ms step_avg:178.76ms
step:999/1440 train_loss:3.5288 train_time:176794ms step_avg:178.76ms
step:1000/1440 train_loss:3.3850 train_time:176978ms step_avg:178.77ms
step:1000/1440 val_loss:3.4115 train_time:177015ms step_avg:178.80ms
step:1001/1440 train_loss:3.4447 train_time:177163ms step_avg:178.77ms
step:1002/1440 train_loss:3.3231 train_time:177347ms step_avg:178.78ms
step:1003/1440 train_loss:3.4998 train_time:177535ms step_avg:178.79ms
step:1004/1440 train_loss:3.5466 train_time:177723ms step_avg:178.80ms
step:1005/1440 train_loss:3.3416 train_time:177907ms step_avg:178.80ms
step:1006/1440 train_loss:3.4130 train_time:178094ms step_avg:178.81ms
step:1007/1440 train_loss:3.3812 train_time:178278ms step_avg:178.81ms
step:1008/1440 train_loss:3.5024 train_time:178464ms step_avg:178.82ms
step:1009/1440 train_loss:3.6088 train_time:178655ms step_avg:178.83ms
step:1010/1440 train_loss:3.5056 train_time:178838ms step_avg:178.84ms
step:1011/1440 train_loss:3.4796 train_time:179021ms step_avg:178.84ms
step:1012/1440 train_loss:3.3397 train_time:179205ms step_avg:178.85ms
step:1013/1440 train_loss:3.4815 train_time:179390ms step_avg:178.85ms
step:1014/1440 train_loss:3.5638 train_time:179574ms step_avg:178.86ms
step:1015/1440 train_loss:3.2715 train_time:179759ms step_avg:178.86ms
step:1016/1440 train_loss:3.3497 train_time:179942ms step_avg:178.87ms
step:1017/1440 train_loss:3.3347 train_time:180129ms step_avg:178.88ms
step:1018/1440 train_loss:3.3441 train_time:180314ms step_avg:178.88ms
step:1019/1440 train_loss:3.4653 train_time:180498ms step_avg:178.89ms
step:1020/1440 train_loss:3.3158 train_time:180682ms step_avg:178.89ms
step:1021/1440 train_loss:3.3019 train_time:180864ms step_avg:178.90ms
step:1022/1440 train_loss:3.4257 train_time:181047ms step_avg:178.90ms
step:1023/1440 train_loss:3.4469 train_time:181231ms step_avg:178.91ms
step:1024/1440 train_loss:3.4203 train_time:181415ms step_avg:178.91ms
step:1025/1440 train_loss:3.4211 train_time:181600ms step_avg:178.92ms
step:1026/1440 train_loss:3.5584 train_time:181783ms step_avg:178.92ms
step:1027/1440 train_loss:3.2673 train_time:181966ms step_avg:178.92ms
step:1028/1440 train_loss:3.3429 train_time:182156ms step_avg:178.94ms
step:1029/1440 train_loss:3.2564 train_time:182344ms step_avg:178.94ms
step:1030/1440 train_loss:3.4871 train_time:182526ms step_avg:178.95ms
step:1031/1440 train_loss:3.4504 train_time:182710ms step_avg:178.95ms
step:1032/1440 train_loss:3.6407 train_time:182898ms step_avg:178.96ms
step:1033/1440 train_loss:3.4417 train_time:183080ms step_avg:178.96ms
step:1034/1440 train_loss:3.3439 train_time:183262ms step_avg:178.97ms
step:1035/1440 train_loss:3.3990 train_time:183447ms step_avg:178.97ms
step:1036/1440 train_loss:3.4262 train_time:183632ms step_avg:178.98ms
step:1037/1440 train_loss:3.7288 train_time:183815ms step_avg:178.98ms
step:1038/1440 train_loss:3.5652 train_time:183999ms step_avg:178.99ms
step:1039/1440 train_loss:3.4600 train_time:184185ms step_avg:178.99ms
step:1040/1440 train_loss:3.3599 train_time:184368ms step_avg:179.00ms
step:1041/1440 train_loss:3.4360 train_time:184554ms step_avg:179.00ms
step:1042/1440 train_loss:3.4664 train_time:184735ms step_avg:179.01ms
step:1043/1440 train_loss:3.3924 train_time:184918ms step_avg:179.01ms
step:1044/1440 train_loss:3.4075 train_time:185102ms step_avg:179.02ms
step:1045/1440 train_loss:3.4626 train_time:185287ms step_avg:179.02ms
step:1046/1440 train_loss:3.3726 train_time:185469ms step_avg:179.02ms
step:1047/1440 train_loss:3.5756 train_time:185653ms step_avg:179.03ms
step:1048/1440 train_loss:3.4429 train_time:185837ms step_avg:179.03ms
step:1049/1440 train_loss:3.3446 train_time:186022ms step_avg:179.04ms
step:1050/1440 train_loss:3.3410 train_time:186208ms step_avg:179.05ms
step:1051/1440 train_loss:3.4462 train_time:186393ms step_avg:179.05ms
step:1052/1440 train_loss:3.2983 train_time:186577ms step_avg:179.06ms
step:1053/1440 train_loss:3.6384 train_time:186758ms step_avg:179.06ms
step:1054/1440 train_loss:3.4822 train_time:186944ms step_avg:179.07ms
step:1055/1440 train_loss:3.3321 train_time:187126ms step_avg:179.07ms
step:1056/1440 train_loss:3.4432 train_time:187309ms step_avg:179.07ms
step:1057/1440 train_loss:3.5277 train_time:187495ms step_avg:179.08ms
step:1058/1440 train_loss:3.2551 train_time:187681ms step_avg:179.08ms
step:1059/1440 train_loss:3.3137 train_time:187871ms step_avg:179.10ms
step:1060/1440 train_loss:3.3829 train_time:188053ms step_avg:179.10ms
step:1061/1440 train_loss:3.3676 train_time:188234ms step_avg:179.10ms
step:1062/1440 train_loss:3.3327 train_time:188417ms step_avg:179.10ms
step:1063/1440 train_loss:3.4033 train_time:188600ms step_avg:179.11ms
step:1064/1440 train_loss:3.3324 train_time:188782ms step_avg:179.11ms
step:1065/1440 train_loss:3.3116 train_time:188970ms step_avg:179.12ms
step:1066/1440 train_loss:3.3677 train_time:189154ms step_avg:179.12ms
step:1067/1440 train_loss:3.2220 train_time:189341ms step_avg:179.13ms
step:1068/1440 train_loss:3.3859 train_time:189525ms step_avg:179.14ms
step:1069/1440 train_loss:3.2504 train_time:189717ms step_avg:179.15ms
step:1070/1440 train_loss:3.5176 train_time:189904ms step_avg:179.16ms
step:1071/1440 train_loss:3.4662 train_time:190095ms step_avg:179.17ms
step:1072/1440 train_loss:3.3859 train_time:190279ms step_avg:179.17ms
step:1073/1440 train_loss:3.4724 train_time:190462ms step_avg:179.17ms
step:1074/1440 train_loss:3.3709 train_time:190648ms step_avg:179.18ms
step:1075/1440 train_loss:3.3520 train_time:190835ms step_avg:179.19ms
step:1076/1440 train_loss:3.7489 train_time:191019ms step_avg:179.19ms
step:1077/1440 train_loss:3.3664 train_time:191203ms step_avg:179.20ms
step:1078/1440 train_loss:3.0408 train_time:191404ms step_avg:179.22ms
step:1079/1440 train_loss:3.4881 train_time:191588ms step_avg:179.22ms
step:1080/1440 train_loss:3.3771 train_time:191778ms step_avg:179.23ms
step:1081/1440 train_loss:3.4468 train_time:191960ms step_avg:179.23ms
step:1082/1440 train_loss:3.5396 train_time:192147ms step_avg:179.24ms
step:1083/1440 train_loss:3.4509 train_time:192331ms step_avg:179.25ms
step:1084/1440 train_loss:3.4063 train_time:192516ms step_avg:179.25ms
step:1085/1440 train_loss:3.3815 train_time:192700ms step_avg:179.26ms
step:1086/1440 train_loss:3.5799 train_time:192886ms step_avg:179.26ms
step:1087/1440 train_loss:3.4491 train_time:193072ms step_avg:179.27ms
step:1088/1440 train_loss:3.3256 train_time:193261ms step_avg:179.28ms
step:1089/1440 train_loss:3.3270 train_time:193451ms step_avg:179.29ms
step:1090/1440 train_loss:3.4275 train_time:193641ms step_avg:179.30ms
step:1091/1440 train_loss:3.2345 train_time:193828ms step_avg:179.30ms
step:1092/1440 train_loss:3.4403 train_time:194014ms step_avg:179.31ms
step:1093/1440 train_loss:3.5498 train_time:194202ms step_avg:179.32ms
step:1094/1440 train_loss:3.3970 train_time:194385ms step_avg:179.32ms
step:1095/1440 train_loss:3.3693 train_time:194570ms step_avg:179.33ms
step:1096/1440 train_loss:3.3768 train_time:194759ms step_avg:179.34ms
step:1097/1440 train_loss:3.4402 train_time:194947ms step_avg:179.34ms
step:1098/1440 train_loss:3.5130 train_time:195136ms step_avg:179.35ms
step:1099/1440 train_loss:3.4840 train_time:195325ms step_avg:179.36ms
step:1100/1440 train_loss:3.3770 train_time:195514ms step_avg:179.37ms
step:1101/1440 train_loss:3.2425 train_time:195701ms step_avg:179.38ms
step:1102/1440 train_loss:3.2559 train_time:195893ms step_avg:179.39ms
step:1103/1440 train_loss:3.3965 train_time:196083ms step_avg:179.40ms
step:1104/1440 train_loss:3.2772 train_time:196267ms step_avg:179.40ms
step:1105/1440 train_loss:4.0158 train_time:196454ms step_avg:179.41ms
step:1106/1440 train_loss:3.1763 train_time:196638ms step_avg:179.41ms
step:1107/1440 train_loss:3.5199 train_time:196823ms step_avg:179.42ms
step:1108/1440 train_loss:3.2968 train_time:197006ms step_avg:179.42ms
step:1109/1440 train_loss:3.4542 train_time:197190ms step_avg:179.43ms
step:1110/1440 train_loss:3.3768 train_time:197375ms step_avg:179.43ms
step:1111/1440 train_loss:3.4386 train_time:197560ms step_avg:179.44ms
step:1112/1440 train_loss:3.5121 train_time:197750ms step_avg:179.45ms
step:1113/1440 train_loss:3.3850 train_time:197942ms step_avg:179.46ms
step:1114/1440 train_loss:3.3318 train_time:198131ms step_avg:179.47ms
step:1115/1440 train_loss:3.1827 train_time:198319ms step_avg:179.47ms
step:1116/1440 train_loss:3.3781 train_time:198502ms step_avg:179.48ms
step:1117/1440 train_loss:3.5368 train_time:198692ms step_avg:179.49ms
step:1118/1440 train_loss:3.5824 train_time:198880ms step_avg:179.49ms
step:1119/1440 train_loss:3.4377 train_time:199065ms step_avg:179.50ms
step:1120/1440 train_loss:3.4408 train_time:199252ms step_avg:179.51ms
step:1121/1440 train_loss:3.3367 train_time:199439ms step_avg:179.51ms
step:1122/1440 train_loss:3.4141 train_time:199621ms step_avg:179.51ms
step:1123/1440 train_loss:3.5298 train_time:199805ms step_avg:179.52ms
step:1124/1440 train_loss:3.2905 train_time:199992ms step_avg:179.53ms
step:1125/1440 train_loss:3.1709 train_time:200178ms step_avg:179.53ms
step:1125/1440 val_loss:3.3602 train_time:200213ms step_avg:179.56ms
step:1126/1440 train_loss:3.4257 train_time:200363ms step_avg:179.54ms
step:1127/1440 train_loss:3.6206 train_time:200550ms step_avg:179.54ms
step:1128/1440 train_loss:3.1863 train_time:200736ms step_avg:179.55ms
step:1129/1440 train_loss:3.5055 train_time:200923ms step_avg:179.56ms
step:1130/1440 train_loss:3.3336 train_time:201110ms step_avg:179.56ms
step:1131/1440 train_loss:3.3534 train_time:201303ms step_avg:179.57ms
step:1132/1440 train_loss:3.3187 train_time:201484ms step_avg:179.58ms
step:1133/1440 train_loss:3.4291 train_time:201844ms step_avg:179.74ms
step:1134/1440 train_loss:3.3971 train_time:202031ms step_avg:179.74ms
step:1135/1440 train_loss:3.4771 train_time:202216ms step_avg:179.75ms
step:1136/1440 train_loss:3.5195 train_time:202402ms step_avg:179.75ms
step:1137/1440 train_loss:3.4115 train_time:202587ms step_avg:179.76ms
step:1138/1440 train_loss:3.3071 train_time:202775ms step_avg:179.77ms
step:1139/1440 train_loss:3.6049 train_time:203106ms step_avg:179.90ms
step:1140/1440 train_loss:3.4115 train_time:203291ms step_avg:179.90ms
step:1141/1440 train_loss:3.5526 train_time:203478ms step_avg:179.91ms
step:1142/1440 train_loss:3.3946 train_time:203663ms step_avg:179.91ms
step:1143/1440 train_loss:3.3250 train_time:203849ms step_avg:179.92ms
step:1144/1440 train_loss:3.3885 train_time:204035ms step_avg:179.92ms
step:1145/1440 train_loss:3.5401 train_time:204220ms step_avg:179.93ms
step:1146/1440 train_loss:3.5155 train_time:204411ms step_avg:179.94ms
step:1147/1440 train_loss:3.4436 train_time:204596ms step_avg:179.94ms
step:1148/1440 train_loss:3.4541 train_time:204780ms step_avg:179.95ms
step:1149/1440 train_loss:3.2765 train_time:204967ms step_avg:179.95ms
step:1150/1440 train_loss:3.3304 train_time:205150ms step_avg:179.96ms
step:1151/1440 train_loss:3.2732 train_time:205338ms step_avg:179.96ms
step:1152/1440 train_loss:3.3420 train_time:205527ms step_avg:179.97ms
step:1153/1440 train_loss:3.3811 train_time:205715ms step_avg:179.98ms
step:1154/1440 train_loss:3.4741 train_time:205898ms step_avg:179.98ms
step:1155/1440 train_loss:3.2702 train_time:206086ms step_avg:179.99ms
step:1156/1440 train_loss:3.4913 train_time:206277ms step_avg:180.00ms
step:1157/1440 train_loss:3.4448 train_time:206461ms step_avg:180.00ms
step:1158/1440 train_loss:3.1932 train_time:206644ms step_avg:180.00ms
step:1159/1440 train_loss:3.3054 train_time:206829ms step_avg:180.01ms
step:1160/1440 train_loss:3.2953 train_time:207012ms step_avg:180.01ms
step:1161/1440 train_loss:3.0311 train_time:207200ms step_avg:180.02ms
step:1162/1440 train_loss:3.3796 train_time:207385ms step_avg:180.02ms
step:1163/1440 train_loss:3.3465 train_time:207575ms step_avg:180.03ms
step:1164/1440 train_loss:3.2524 train_time:207759ms step_avg:180.03ms
step:1165/1440 train_loss:3.2006 train_time:207941ms step_avg:180.04ms
step:1166/1440 train_loss:3.3475 train_time:208126ms step_avg:180.04ms
step:1167/1440 train_loss:3.3727 train_time:208310ms step_avg:180.04ms
step:1168/1440 train_loss:3.6782 train_time:208494ms step_avg:180.05ms
step:1169/1440 train_loss:3.3327 train_time:208680ms step_avg:180.05ms
step:1170/1440 train_loss:3.3437 train_time:208863ms step_avg:180.05ms
step:1171/1440 train_loss:3.2361 train_time:209048ms step_avg:180.06ms
step:1172/1440 train_loss:3.3808 train_time:209228ms step_avg:180.06ms
step:1173/1440 train_loss:3.4892 train_time:209419ms step_avg:180.07ms
step:1174/1440 train_loss:3.3360 train_time:209610ms step_avg:180.08ms
step:1175/1440 train_loss:3.3212 train_time:209800ms step_avg:180.09ms
step:1176/1440 train_loss:3.3763 train_time:209993ms step_avg:180.10ms
step:1177/1440 train_loss:3.4086 train_time:210184ms step_avg:180.11ms
step:1178/1440 train_loss:3.4548 train_time:210372ms step_avg:180.11ms
step:1179/1440 train_loss:3.3559 train_time:210559ms step_avg:180.12ms
step:1180/1440 train_loss:3.3004 train_time:210759ms step_avg:180.14ms
step:1181/1440 train_loss:3.2928 train_time:210944ms step_avg:180.14ms
step:1182/1440 train_loss:3.3226 train_time:211131ms step_avg:180.15ms
step:1183/1440 train_loss:3.2907 train_time:211317ms step_avg:180.15ms
step:1184/1440 train_loss:3.4700 train_time:211505ms step_avg:180.16ms
step:1185/1440 train_loss:3.4995 train_time:211698ms step_avg:180.17ms
step:1186/1440 train_loss:3.3216 train_time:211891ms step_avg:180.18ms
step:1187/1440 train_loss:3.3759 train_time:212087ms step_avg:180.19ms
step:1188/1440 train_loss:3.4002 train_time:212270ms step_avg:180.19ms
step:1189/1440 train_loss:3.2311 train_time:212457ms step_avg:180.20ms
step:1190/1440 train_loss:3.4038 train_time:212647ms step_avg:180.21ms
step:1191/1440 train_loss:3.5393 train_time:212837ms step_avg:180.22ms
step:1192/1440 train_loss:3.3481 train_time:213019ms step_avg:180.22ms
step:1193/1440 train_loss:3.2367 train_time:213205ms step_avg:180.22ms
step:1194/1440 train_loss:3.5183 train_time:213394ms step_avg:180.23ms
step:1195/1440 train_loss:3.3318 train_time:213587ms step_avg:180.24ms
step:1196/1440 train_loss:3.3442 train_time:213784ms step_avg:180.26ms
step:1197/1440 train_loss:3.2577 train_time:213977ms step_avg:180.27ms
step:1198/1440 train_loss:3.2599 train_time:214173ms step_avg:180.28ms
step:1199/1440 train_loss:3.3043 train_time:214360ms step_avg:180.29ms
step:1200/1440 train_loss:3.4096 train_time:214544ms step_avg:180.29ms
step:1201/1440 train_loss:3.4359 train_time:214733ms step_avg:180.30ms
step:1202/1440 train_loss:3.5606 train_time:214935ms step_avg:180.31ms
step:1203/1440 train_loss:3.3669 train_time:215122ms step_avg:180.32ms
step:1204/1440 train_loss:3.2618 train_time:215315ms step_avg:180.33ms
step:1205/1440 train_loss:3.4007 train_time:215501ms step_avg:180.34ms
step:1206/1440 train_loss:3.4324 train_time:215686ms step_avg:180.34ms
step:1207/1440 train_loss:3.4712 train_time:215874ms step_avg:180.35ms
step:1208/1440 train_loss:3.3554 train_time:216058ms step_avg:180.35ms
step:1209/1440 train_loss:3.2082 train_time:216250ms step_avg:180.36ms
step:1210/1440 train_loss:3.2633 train_time:216440ms step_avg:180.37ms
step:1211/1440 train_loss:3.3542 train_time:216626ms step_avg:180.37ms
step:1212/1440 train_loss:3.3562 train_time:216816ms step_avg:180.38ms
step:1213/1440 train_loss:3.3641 train_time:217006ms step_avg:180.39ms
step:1214/1440 train_loss:3.1968 train_time:217200ms step_avg:180.40ms
step:1215/1440 train_loss:3.3572 train_time:217382ms step_avg:180.40ms
step:1216/1440 train_loss:3.2877 train_time:217568ms step_avg:180.40ms
step:1217/1440 train_loss:3.2808 train_time:217754ms step_avg:180.41ms
step:1218/1440 train_loss:3.3669 train_time:217941ms step_avg:180.41ms
step:1219/1440 train_loss:3.2111 train_time:218135ms step_avg:180.43ms
step:1220/1440 train_loss:3.4330 train_time:218320ms step_avg:180.43ms
step:1221/1440 train_loss:3.4660 train_time:218505ms step_avg:180.43ms
step:1222/1440 train_loss:3.3845 train_time:218690ms step_avg:180.44ms
step:1223/1440 train_loss:3.2580 train_time:218878ms step_avg:180.44ms
step:1224/1440 train_loss:3.2134 train_time:219071ms step_avg:180.45ms
step:1225/1440 train_loss:3.3285 train_time:219257ms step_avg:180.46ms
step:1226/1440 train_loss:3.2946 train_time:219446ms step_avg:180.47ms
step:1227/1440 train_loss:3.2363 train_time:219637ms step_avg:180.47ms
step:1228/1440 train_loss:3.4111 train_time:219819ms step_avg:180.48ms
step:1229/1440 train_loss:3.3285 train_time:220009ms step_avg:180.48ms
step:1230/1440 train_loss:3.3576 train_time:220204ms step_avg:180.50ms
step:1231/1440 train_loss:3.5380 train_time:220393ms step_avg:180.50ms
step:1232/1440 train_loss:3.4620 train_time:220581ms step_avg:180.51ms
step:1233/1440 train_loss:3.3905 train_time:220765ms step_avg:180.51ms
step:1234/1440 train_loss:3.5453 train_time:220954ms step_avg:180.52ms
step:1235/1440 train_loss:3.2810 train_time:221142ms step_avg:180.52ms
step:1236/1440 train_loss:3.2467 train_time:221327ms step_avg:180.53ms
step:1237/1440 train_loss:3.2390 train_time:221515ms step_avg:180.53ms
step:1238/1440 train_loss:3.2379 train_time:221707ms step_avg:180.54ms
step:1239/1440 train_loss:3.2933 train_time:221894ms step_avg:180.55ms
step:1240/1440 train_loss:3.3485 train_time:222081ms step_avg:180.55ms
step:1241/1440 train_loss:3.3838 train_time:222270ms step_avg:180.56ms
step:1242/1440 train_loss:3.2634 train_time:222456ms step_avg:180.56ms
step:1243/1440 train_loss:3.3680 train_time:222642ms step_avg:180.57ms
step:1244/1440 train_loss:3.3651 train_time:222824ms step_avg:180.57ms
step:1245/1440 train_loss:3.3696 train_time:223012ms step_avg:180.58ms
step:1246/1440 train_loss:3.2092 train_time:223200ms step_avg:180.58ms
step:1247/1440 train_loss:3.3407 train_time:223385ms step_avg:180.59ms
step:1248/1440 train_loss:3.3908 train_time:223570ms step_avg:180.59ms
step:1249/1440 train_loss:3.3878 train_time:223756ms step_avg:180.59ms
step:1250/1440 train_loss:3.2705 train_time:223940ms step_avg:180.60ms
step:1250/1440 val_loss:3.3174 train_time:223977ms step_avg:180.63ms
step:1251/1440 train_loss:3.4451 train_time:224134ms step_avg:180.61ms
step:1252/1440 train_loss:3.3247 train_time:224317ms step_avg:180.61ms
step:1253/1440 train_loss:3.2742 train_time:224503ms step_avg:180.61ms
step:1254/1440 train_loss:3.3747 train_time:224692ms step_avg:180.62ms
step:1255/1440 train_loss:3.4824 train_time:224883ms step_avg:180.63ms
step:1256/1440 train_loss:3.2649 train_time:225074ms step_avg:180.64ms
step:1257/1440 train_loss:3.3380 train_time:225258ms step_avg:180.64ms
step:1258/1440 train_loss:3.3295 train_time:225450ms step_avg:180.65ms
step:1259/1440 train_loss:3.2897 train_time:225635ms step_avg:180.65ms
step:1260/1440 train_loss:3.1748 train_time:225818ms step_avg:180.65ms
step:1261/1440 train_loss:3.2630 train_time:226006ms step_avg:180.66ms
step:1262/1440 train_loss:3.2876 train_time:226197ms step_avg:180.67ms
step:1263/1440 train_loss:3.2060 train_time:226383ms step_avg:180.67ms
step:1264/1440 train_loss:3.4048 train_time:226565ms step_avg:180.67ms
step:1265/1440 train_loss:3.3888 train_time:226749ms step_avg:180.68ms
step:1266/1440 train_loss:3.4075 train_time:226934ms step_avg:180.68ms
step:1267/1440 train_loss:3.3366 train_time:227120ms step_avg:180.68ms
step:1268/1440 train_loss:3.3791 train_time:227308ms step_avg:180.69ms
step:1269/1440 train_loss:3.2177 train_time:227501ms step_avg:180.70ms
step:1270/1440 train_loss:3.0669 train_time:227685ms step_avg:180.70ms
step:1271/1440 train_loss:3.3681 train_time:227872ms step_avg:180.71ms
step:1272/1440 train_loss:3.3190 train_time:228054ms step_avg:180.71ms
step:1273/1440 train_loss:3.3335 train_time:228241ms step_avg:180.71ms
step:1274/1440 train_loss:3.3241 train_time:228428ms step_avg:180.72ms
step:1275/1440 train_loss:3.3996 train_time:228614ms step_avg:180.72ms
step:1276/1440 train_loss:3.4335 train_time:228794ms step_avg:180.72ms
step:1277/1440 train_loss:3.3752 train_time:228982ms step_avg:180.73ms
step:1278/1440 train_loss:3.3734 train_time:229164ms step_avg:180.73ms
step:1279/1440 train_loss:3.2378 train_time:229351ms step_avg:180.73ms
step:1280/1440 train_loss:3.3295 train_time:229540ms step_avg:180.74ms
step:1281/1440 train_loss:3.3939 train_time:229725ms step_avg:180.74ms
step:1282/1440 train_loss:3.4365 train_time:229907ms step_avg:180.74ms
step:1283/1440 train_loss:3.2969 train_time:230099ms step_avg:180.75ms
step:1284/1440 train_loss:3.3367 train_time:230287ms step_avg:180.76ms
step:1285/1440 train_loss:3.3264 train_time:230475ms step_avg:180.76ms
step:1286/1440 train_loss:3.3009 train_time:230660ms step_avg:180.77ms
step:1287/1440 train_loss:3.4553 train_time:230849ms step_avg:180.77ms
step:1288/1440 train_loss:3.2660 train_time:231040ms step_avg:180.78ms
step:1289/1440 train_loss:3.3455 train_time:231238ms step_avg:180.80ms
step:1290/1440 train_loss:3.4222 train_time:231434ms step_avg:180.81ms
step:1291/1440 train_loss:3.3511 train_time:231620ms step_avg:180.81ms
step:1292/1440 train_loss:3.4449 train_time:231811ms step_avg:180.82ms
step:1293/1440 train_loss:3.4825 train_time:232000ms step_avg:180.83ms
step:1294/1440 train_loss:3.4225 train_time:232193ms step_avg:180.84ms
step:1295/1440 train_loss:3.2486 train_time:232379ms step_avg:180.84ms
step:1296/1440 train_loss:3.3464 train_time:232569ms step_avg:180.85ms
step:1297/1440 train_loss:3.2424 train_time:232755ms step_avg:180.85ms
step:1298/1440 train_loss:3.2329 train_time:232945ms step_avg:180.86ms
step:1299/1440 train_loss:3.3600 train_time:233132ms step_avg:180.86ms
step:1300/1440 train_loss:3.3742 train_time:233317ms step_avg:180.87ms
step:1301/1440 train_loss:3.3703 train_time:233503ms step_avg:180.87ms
step:1302/1440 train_loss:3.5479 train_time:233695ms step_avg:180.88ms
step:1303/1440 train_loss:3.2726 train_time:233888ms step_avg:180.89ms
step:1304/1440 train_loss:3.4728 train_time:234079ms step_avg:180.90ms
step:1305/1440 train_loss:3.2271 train_time:234264ms step_avg:180.90ms
step:1306/1440 train_loss:3.4208 train_time:234457ms step_avg:180.91ms
step:1307/1440 train_loss:3.4291 train_time:234639ms step_avg:180.91ms
step:1308/1440 train_loss:3.2570 train_time:234827ms step_avg:180.91ms
step:1309/1440 train_loss:3.2836 train_time:235016ms step_avg:180.92ms
step:1310/1440 train_loss:3.2578 train_time:235202ms step_avg:180.92ms
step:1311/1440 train_loss:3.2660 train_time:235389ms step_avg:180.93ms
step:1312/1440 train_loss:3.3430 train_time:235578ms step_avg:180.94ms
step:1313/1440 train_loss:3.3121 train_time:235767ms step_avg:180.94ms
step:1314/1440 train_loss:3.0077 train_time:235960ms step_avg:180.95ms
step:1315/1440 train_loss:3.2445 train_time:236146ms step_avg:180.95ms
step:1316/1440 train_loss:3.3704 train_time:236330ms step_avg:180.96ms
step:1317/1440 train_loss:3.3949 train_time:236517ms step_avg:180.96ms
step:1318/1440 train_loss:3.2793 train_time:236714ms step_avg:180.97ms
step:1319/1440 train_loss:3.3975 train_time:236901ms step_avg:180.98ms
step:1320/1440 train_loss:3.4291 train_time:237094ms step_avg:180.99ms
step:1321/1440 train_loss:3.3379 train_time:237285ms step_avg:181.00ms
step:1322/1440 train_loss:3.2976 train_time:237617ms step_avg:181.11ms
step:1323/1440 train_loss:3.2922 train_time:237809ms step_avg:181.12ms
step:1324/1440 train_loss:3.4056 train_time:238001ms step_avg:181.13ms
step:1325/1440 train_loss:3.4601 train_time:238194ms step_avg:181.14ms
step:1326/1440 train_loss:3.1737 train_time:238384ms step_avg:181.14ms
step:1327/1440 train_loss:3.1398 train_time:238568ms step_avg:181.15ms
step:1328/1440 train_loss:3.4670 train_time:238761ms step_avg:181.15ms
step:1329/1440 train_loss:3.2635 train_time:239110ms step_avg:181.28ms
step:1330/1440 train_loss:3.3909 train_time:239303ms step_avg:181.29ms
step:1331/1440 train_loss:3.3046 train_time:239486ms step_avg:181.29ms
step:1332/1440 train_loss:3.7117 train_time:239677ms step_avg:181.30ms
step:1333/1440 train_loss:3.4484 train_time:239865ms step_avg:181.30ms
step:1334/1440 train_loss:3.3437 train_time:240052ms step_avg:181.31ms
step:1335/1440 train_loss:3.2607 train_time:240240ms step_avg:181.31ms
step:1336/1440 train_loss:3.2665 train_time:240432ms step_avg:181.32ms
step:1337/1440 train_loss:3.5200 train_time:240622ms step_avg:181.33ms
step:1338/1440 train_loss:3.4988 train_time:240811ms step_avg:181.33ms
step:1339/1440 train_loss:3.3086 train_time:240999ms step_avg:181.34ms
step:1340/1440 train_loss:3.2547 train_time:241183ms step_avg:181.34ms
step:1341/1440 train_loss:3.5624 train_time:241367ms step_avg:181.34ms
step:1342/1440 train_loss:3.3289 train_time:241556ms step_avg:181.35ms
step:1343/1440 train_loss:3.3420 train_time:241740ms step_avg:181.35ms
step:1344/1440 train_loss:3.3837 train_time:241928ms step_avg:181.36ms
step:1345/1440 train_loss:3.3482 train_time:242117ms step_avg:181.36ms
step:1346/1440 train_loss:3.2727 train_time:242304ms step_avg:181.37ms
step:1347/1440 train_loss:3.2562 train_time:242491ms step_avg:181.37ms
step:1348/1440 train_loss:3.3185 train_time:242677ms step_avg:181.37ms
step:1349/1440 train_loss:3.2465 train_time:242865ms step_avg:181.38ms
step:1350/1440 train_loss:3.3588 train_time:243055ms step_avg:181.38ms
step:1351/1440 train_loss:3.2231 train_time:243240ms step_avg:181.39ms
step:1352/1440 train_loss:3.2835 train_time:243427ms step_avg:181.39ms
step:1353/1440 train_loss:3.3737 train_time:243616ms step_avg:181.40ms
step:1354/1440 train_loss:3.2323 train_time:243804ms step_avg:181.40ms
step:1355/1440 train_loss:3.1700 train_time:243991ms step_avg:181.41ms
step:1356/1440 train_loss:3.4861 train_time:244178ms step_avg:181.41ms
step:1357/1440 train_loss:3.3941 train_time:244367ms step_avg:181.42ms
step:1358/1440 train_loss:3.1646 train_time:244553ms step_avg:181.42ms
step:1359/1440 train_loss:3.4125 train_time:244741ms step_avg:181.42ms
step:1360/1440 train_loss:3.3279 train_time:244930ms step_avg:181.43ms
step:1361/1440 train_loss:3.0914 train_time:245124ms step_avg:181.44ms
step:1362/1440 train_loss:3.3632 train_time:245310ms step_avg:181.44ms
step:1363/1440 train_loss:3.2623 train_time:245502ms step_avg:181.45ms
step:1364/1440 train_loss:3.2773 train_time:245686ms step_avg:181.45ms
step:1365/1440 train_loss:3.2904 train_time:245871ms step_avg:181.45ms
step:1366/1440 train_loss:3.3968 train_time:246058ms step_avg:181.46ms
step:1367/1440 train_loss:3.3764 train_time:246244ms step_avg:181.46ms
step:1368/1440 train_loss:3.3174 train_time:246432ms step_avg:181.47ms
step:1369/1440 train_loss:3.2498 train_time:246628ms step_avg:181.48ms
step:1370/1440 train_loss:3.5805 train_time:246813ms step_avg:181.48ms
step:1371/1440 train_loss:3.2890 train_time:247003ms step_avg:181.49ms
step:1372/1440 train_loss:3.3477 train_time:247192ms step_avg:181.49ms
step:1373/1440 train_loss:3.3421 train_time:247381ms step_avg:181.50ms
step:1374/1440 train_loss:3.1259 train_time:247570ms step_avg:181.50ms
step:1375/1440 train_loss:3.5024 train_time:247756ms step_avg:181.51ms
step:1375/1440 val_loss:3.2866 train_time:247791ms step_avg:181.53ms
step:1376/1440 train_loss:3.3198 train_time:247942ms step_avg:181.51ms
step:1377/1440 train_loss:3.4576 train_time:248130ms step_avg:181.51ms
step:1378/1440 train_loss:3.4414 train_time:248315ms step_avg:181.52ms
step:1379/1440 train_loss:3.0840 train_time:248504ms step_avg:181.52ms
step:1380/1440 train_loss:3.2847 train_time:248689ms step_avg:181.53ms
step:1381/1440 train_loss:3.6656 train_time:248883ms step_avg:181.53ms
step:1382/1440 train_loss:3.1889 train_time:249068ms step_avg:181.54ms
step:1383/1440 train_loss:3.3736 train_time:249256ms step_avg:181.54ms
step:1384/1440 train_loss:3.4514 train_time:249444ms step_avg:181.55ms
step:1385/1440 train_loss:3.3839 train_time:249626ms step_avg:181.55ms
step:1386/1440 train_loss:3.3134 train_time:249813ms step_avg:181.55ms
step:1387/1440 train_loss:3.1817 train_time:250001ms step_avg:181.55ms
step:1388/1440 train_loss:3.3249 train_time:250190ms step_avg:181.56ms
step:1389/1440 train_loss:3.2937 train_time:250381ms step_avg:181.57ms
step:1390/1440 train_loss:3.5401 train_time:250567ms step_avg:181.57ms
step:1391/1440 train_loss:3.2708 train_time:250754ms step_avg:181.57ms
step:1392/1440 train_loss:3.2685 train_time:250939ms step_avg:181.58ms
step:1393/1440 train_loss:3.2110 train_time:251129ms step_avg:181.58ms
step:1394/1440 train_loss:3.4753 train_time:251316ms step_avg:181.59ms
step:1395/1440 train_loss:3.3632 train_time:251502ms step_avg:181.59ms
step:1396/1440 train_loss:3.3860 train_time:251686ms step_avg:181.59ms
step:1397/1440 train_loss:3.2852 train_time:251872ms step_avg:181.59ms
step:1398/1440 train_loss:3.2366 train_time:252055ms step_avg:181.60ms
step:1399/1440 train_loss:3.2963 train_time:252243ms step_avg:181.60ms
step:1400/1440 train_loss:3.2985 train_time:252436ms step_avg:181.61ms
step:1401/1440 train_loss:3.3302 train_time:252619ms step_avg:181.61ms
step:1402/1440 train_loss:3.2795 train_time:252805ms step_avg:181.61ms
step:1403/1440 train_loss:3.4719 train_time:253002ms step_avg:181.62ms
step:1404/1440 train_loss:3.2612 train_time:253187ms step_avg:181.63ms
step:1405/1440 train_loss:3.2965 train_time:253378ms step_avg:181.63ms
step:1406/1440 train_loss:3.2919 train_time:253566ms step_avg:181.64ms
step:1407/1440 train_loss:3.1514 train_time:253753ms step_avg:181.64ms
step:1408/1440 train_loss:3.2941 train_time:253945ms step_avg:181.65ms
step:1409/1440 train_loss:3.2827 train_time:254139ms step_avg:181.66ms
step:1410/1440 train_loss:3.2700 train_time:254325ms step_avg:181.66ms
step:1411/1440 train_loss:3.3457 train_time:254509ms step_avg:181.66ms
step:1412/1440 train_loss:3.3150 train_time:254696ms step_avg:181.67ms
step:1413/1440 train_loss:3.3410 train_time:254884ms step_avg:181.67ms
step:1414/1440 train_loss:3.3126 train_time:255074ms step_avg:181.68ms
step:1415/1440 train_loss:3.3858 train_time:255271ms step_avg:181.69ms
step:1416/1440 train_loss:3.2144 train_time:255467ms step_avg:181.70ms
step:1417/1440 train_loss:3.2633 train_time:255659ms step_avg:181.70ms
step:1418/1440 train_loss:3.3746 train_time:255843ms step_avg:181.71ms
step:1419/1440 train_loss:3.3174 train_time:256038ms step_avg:181.72ms
step:1420/1440 train_loss:3.3446 train_time:256226ms step_avg:181.72ms
step:1421/1440 train_loss:3.3535 train_time:256416ms step_avg:181.73ms
step:1422/1440 train_loss:3.3090 train_time:256604ms step_avg:181.73ms
step:1423/1440 train_loss:3.2933 train_time:256795ms step_avg:181.74ms
step:1424/1440 train_loss:3.3167 train_time:256990ms step_avg:181.75ms
step:1425/1440 train_loss:3.1623 train_time:257190ms step_avg:181.76ms
step:1426/1440 train_loss:3.3091 train_time:257375ms step_avg:181.76ms
step:1427/1440 train_loss:3.2689 train_time:257565ms step_avg:181.77ms
step:1428/1440 train_loss:3.3596 train_time:257750ms step_avg:181.77ms
step:1429/1440 train_loss:3.3449 train_time:257934ms step_avg:181.77ms
step:1430/1440 train_loss:3.2418 train_time:258124ms step_avg:181.78ms
step:1431/1440 train_loss:3.3059 train_time:258317ms step_avg:181.79ms
step:1432/1440 train_loss:3.3238 train_time:258509ms step_avg:181.79ms
step:1433/1440 train_loss:3.1107 train_time:258704ms step_avg:181.80ms
step:1434/1440 train_loss:3.2715 train_time:258898ms step_avg:181.81ms
step:1435/1440 train_loss:3.1035 train_time:259087ms step_avg:181.82ms
step:1436/1440 train_loss:3.2139 train_time:259276ms step_avg:181.82ms
step:1437/1440 train_loss:3.3912 train_time:259462ms step_avg:181.82ms
step:1438/1440 train_loss:3.3707 train_time:259647ms step_avg:181.83ms
step:1439/1440 train_loss:3.3002 train_time:259838ms step_avg:181.83ms
step:1440/1440 train_loss:3.1774 train_time:260024ms step_avg:181.83ms
step:1440/1440 val_loss:3.2788 train_time:260064ms step_avg:181.86ms
